<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main" coord="1,71.28,99.20,323.13,12.37">Chemical Structure Reconstruction with chemoCR</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author role="corresp">
							<persName coords="1,71.28,130.32,109.04,9.60"><roleName>Dr</roleName><forename type="first">Marc</forename><surname>Zimmermann</surname></persName>
							<email>team@scai.fraunhofer.de</email>
							<affiliation key="aff0">
								<orgName type="department">Fraunhofer--Institute for Algorithms and Scientific Computing (SCAI) Schloss Birlinghoven</orgName>
								<address>
									<postCode>D--53754</postCode>
									<settlement>Sankt Augustin</settlement>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main" coord="1,71.28,99.20,323.13,12.37">Chemical Structure Reconstruction with chemoCR</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="MD5">8613F59BF81A8A42C96DD83CEF3E0C8C</idno>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.8.0" ident="GROBID" when="2024-08-05T15:05+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>chemoCR makes chemical information contained in depictions of chemical structures accessible as connection table for computer programs. In order to solve the problem of recognizing and translating chemical structures in image documents, our chemoCR system combines pattern recognition techniques with supervised machine learning concepts. The method is based on the idea of identifying from structural formulas the most significant semantic entities. Semantic entities are for example chiral bonds, superatoms and reaction arrows. The workflow consists of three phases: image preprocessing, semantic entity recognition, and molecule reconstruction plus validation of the result. All steps of the process make use of chemical knowledge in order to detect and fix errors. The system can be trained and adapted to different sources of input images. The reconstructed connection table can be used by all chemical software.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<facsimile>
		<surface n="1" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="2" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="3" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="4" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="5" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="6" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="7" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="8" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="9" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="10" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="11" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="12" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
	</facsimile>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.">Problem Description</head><p>Chemical entities can appear in scientific texts as trivial and brand names, assigned catalogue names, or IUPAC names. However, the preferred representation of chemical entities is often a two--dimensional depiction of the chemical structure. Depictions can be found as images in nearly all electronic sources of chemical information (e.g. journals, reports, patents, and web interfaces of chemical databases). Nowadays these images are generated with special drawing programs (e.g. ISISdraw [10], cf. Figure <ref type="figure" coords="2,279.64,176.77,4.97,9.73">1</ref>), either automatically from connection table file formats or by the chemist through a graphical user interface. Although drawing programs can produce and store the information in a computer--readable format, chemical structure depictions are published as bitmap images (e.g. GIF for web interfaces or BMP for text documents). As a consequence, the structure information can no longer be used as input to chemical analysis software packages. To make published chemical structure information available in a computer--readable format, images representing chemical structures have to be manually converted by redrawing every structure. This is a time--consuming and error--prone process <ref type="bibr" coords="2,111.24,293.14,21.54,10.81" target="#b10">[13,</ref><ref type="bibr" coords="2,132.79,293.14,16.19,10.81" target="#b12">15]</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.">Methods</head><p>Several articles are focusing on the chemical compound reconstruction problem (CSR) <ref type="bibr" coords="2,491.24,335.38,13.26,10.81" target="#b2">[3,</ref><ref type="bibr" coords="2,504.50,335.38,17.68,10.81" target="#b5">6,</ref><ref type="bibr" coords="2,522.19,335.38,17.68,10.81" target="#b7">8]</ref>. In order to solve the problem of recognizing and learning chemical structures in image documents, our chemoCR system combines pattern recognition techniques with supervised machine--learning concepts. The method is based on the idea of identifying from depictions the most significant semantic entities (e.g. chiral bonds, superatoms, reaction arrows...). The workflow consists of three phases: image preprocessing, semantic entity recognition, and molecule reconstruction plus validation of the result. All steps of the process make use of chemical knowledge in order to detect and fix errors. The system can be adapted to different sets of input images. The following algorithms have been developed and integrated into the system:</p><p>• a new vectorization algorithm based on textures • a new OCR tool for chemical characters using machine learning</p><p>• a new page segmentation algorithm which makes use of classification of chemical objects in mixed diagrams • a new expert system for the extraction of chemical entities by combining graphical primitives and chemical knowledge • a scoring module for the reconstruction validation The chemoCR core functionality is based on platform--independent JAVA libraries. Details can be found at <ref type="bibr" coords="2,115.38,599.14,15.47,10.81" target="#b0">[1,</ref><ref type="bibr" coords="2,130.85,599.14,11.79,10.81" target="#b1">2,</ref><ref type="bibr" coords="2,142.64,599.14,11.79,10.81" target="#b4">5,</ref><ref type="bibr" coords="2,154.42,599.14,11.79,10.81" target="#b6">7,</ref><ref type="bibr" coords="2,166.21,599.14,17.87,10.81" target="#b10">13,</ref><ref type="bibr" coords="2,184.08,599.14,17.87,10.81" target="#b9">12,</ref><ref type="bibr" coords="2,201.95,599.14,16.19,10.81" target="#b11">14]</ref>. For the Image--to--Structure Task (I2S) we used chemoCR v0.93 running in batch mode using the image set as input and producing a set of SDFiles. As first step the correct parameter set has to be selected. A parameter set is a collection of parameter settings which influence the quality of the reconstruction process. As the shape of lines in pixel images tend to be not generally uniform chemoCR introduced a lot of parameters to adapt to different drawing styles. By now there are 12 different sets of parameters each of which just goes fine with a special sort of input images (e.g. different drawing tools, different journal styles, patents, textbooks). A lot of experience and knowledge went along in optimizing them. A representative set of example images from the training set and the topic set have been manually processed in the graphical user interface and the results have been carefully checked against the provided MOL files. The provided images have been quite uniform using the same drawing style and almost the same image resolution. Therefore we decided to select a single parameter set and apply it to the whole image set. The preconfigured parameter set "Houben--Weyl" has been selected - showing the best results. The Houben--Weyl set has been developed for the book series "Houben--Weyl" which are published by Thieme and contain the description of organic chemistry reactions over a large period of time. Thus the depictions vary in the shown in different chemical scaffolds and drawing style, but the quality of the images is high. The same applies to the provided images from the USPTO. From the manual experimentation a standard workflow has been chosen. A workflow consists of several independent workflow modules which are executed in a predetermined order like a pipeline. This pipeline can be configured by switching modules on and off as necessary. The predefined workflow from chemoCRSettings.xml will binarize the input image, analyze the connected components, extract and convert letters in the image, detect chiral bonds, vectorize simple bonds and bond sets (i.e. ring systems and chains) and finally combine everything into a molecule. If there are several molecules in the image they can be splitted and written in a multi molecule SDF <ref type="bibr" coords="3,145.06,368.26,14.38,10.81">[9]</ref>. The result of the whole process is validated and possible reconstruction errors. We give a short overview on the used workflow modules in the next section. Two preliminary steps (page segmentation and PDF processing) have not been applied as the provided images are already extracted from the patent documents. But they become necessary if one wants to process the original documents.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>The PDF Conversion Task</head><p>Chemical structure depictions are often packed in documents which explain the content of the depiction. These documents are often saved in Adobe Portable Document Format (PDF). To extract the information from the documents chemoCR has a PDF Conversion module, which splits the document to its single pages and saves them as a bitmap image. After this conversion it is recommended to start the Page Segmentation to get the depictions of chemical structures from the set of single pages.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>The Page Segmentation Task for Chemistry Journals</head><p>Scientific literature contains a lot of information which is found not only in text but also in depictions, tables and diagrams. Even though chemistry journals are already digitally available (e.g. as PDF); however for extracting chemical related information like structural formulas from these sources it is necessary to identify and separate chemical objects and their context from the rest of the document. This is a quite complicated task due to the fact that the layout of scientific articles is quite complicated and differs from normal text sources. In the second step the separated chemistry objects are processed by name--to--structure or image--to--structure tools like chemoCR.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>The main Workflow Description</head><p>chemoCR organizes its work in a pipeline of subtasks: the workflow modules. They are grouped into four sections: Preprocessing Section (yellow boxes), Reconstruction Section (light blue boxes), Postprocessing Section (dark blue boxes), and Validation Section (orange boxes). The different modules of the modules of chemoCR will be described in the next sections.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Preprocessing Section</head><p>The following modules belong to the Preprocessing Section. These will analyze and convert the bitmap image into higher abstraction level objects like connected components, vectors and letters. Vaporizer Unit chemoCR's competence in the fields of the reconstruction of chemical structure depictions works best with input images just consisting of structure diagrams. The Vaporizer Unit now serves as an eraser for those parts of the image that are presumably not structure diagrams -but text or other human readable information. The vaporizer just erases any misleading information in the image. But the deleted parts are kept in the output for further processing.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Image Preprocessing</head><p>This module can be used to normalize the input images. The input image can be scaled, rotated, sharpened, eroded (thinning of lines), dilated (thickening of lines) and skeletonized (center line). The effects of the preprocessing can be studied by using the wizard and turn on the live preview. All operations are performed on a copy of the original image.  </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Vectorize Bitmap Image Necessary</head><p>Step. It converts the bitmap image into a set of vectors. This is the main algorithm and relies on the Compute Local Directions module.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Reconstruction Section</head><p>The Reconstruction Section is split in two parts: the Expert System Section part and the part Assembling of the Molecule. Both modules rely on the Chemical Rule System.</p><p>The reconstruction of the image implies that chemical components like bonds or chirals are identified from the pixel image. The information that a specific line is in fact a bond or a double bond is derived by applying so--called rules. A rule inspects a component within its neighborhood and looks at its characteristics to decide if this component belongs to that sort of chemical component that the rule is looking for. There is of course more than one rule necessary to identify all the sorts and shapes of chemical components. The rules together form the rule set. A rule set is an XML file that is open to changes or extensions by the user. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Expert System Section</head><p>The workflow modules listed here do consult the Expert System for reconstruction. Chemical knowledge now is applied. Build the Analysis System Necessary Step. It initializes the analysis system for the graph exploration algorithm. This module collects all information on vectors, connected components and letters and their properties like average length, shape, color etc. Orientation Graph Exploration Necessary Step. It uses a graph constraint exploration algorithm to assign the annotations. Each connected component is visited and suitable rules are evaluated for this component. The successful rule with the highest priority value will define the annotation.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Assembling of the Molecule</head><p>The following modules use the annotations of the annotation container for building the chemical graph. All parts are assembled into semantic objects. E.g. the two vectors which are assigned as double bond are now combined into a single vector with label double bond. Each assembly step can be turned off individually. The according objects will be ignored and not be transferred into the molecule. Assemble Bond Sets Necessary Step. It selects each bondset and adds all vectors of this bondset as bonds to the molecule. Bondsets normally represent ringsystems and aliphatic chains. Assemble Dotted Chirals Necessary Step. It selects each set of vectors belonging to a dotted chiral. All these vectors will lead to a single bond in the molecule. Depending on the representation of the dotted chiral the bond will be oriented. This module checks not for valid chiral centers.  Assemble Superatoms Necessary Step. It selects groups of characters and tests if they are known as superatoms. If there is a suitable synonym in the loaded superatom database it will add the appropriate bonds and atoms to the molecule. Superatoms can be extended and visualized in the molecule panel.  </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Postprocessing Section</head><p>The following modules belong to the Postprocessing Section which will mostly start external programs; Calculate Physico--chemical Properties, Start 3D--Viewer, Start WWW Query. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Delete Small Fragments</head><p>It removes small fragments from the molecule by deleting them. This will remove e.g. Methyl groups resulting from noise in the image or removes salts and counter ions. Split Fragments It creates from each fragment a new molecule. All generated molecules will become a collection which is written to a multi mol SDF file. The collection is shown in a new GUI in the results panel.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Validation Section</head><p>The following modules belong to the Validation Section which will help to analyze the reconstruction result.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Validate Reconstruction</head><p>It analyzes the resulting molecule for existing and possible chemical errors. This module tests valences, bond lengths and angles, typical atom types and fragments. The result is a score between 0 (certainly an error) to 1 (the reconstruction should be perfect). All images have been processed by switching on the validation of the result and cleaning of small fragments, no image preprocessing has been used, and some letters have been trained for the OCR.  The vectorizer of chemoCR can't recognize curves and circles; it can only convert objects into straight lines. Therefore a special kind of aromatic rings cannot be detected (cf. figure <ref type="figure" coords="11,491.15,231.46,10.77,10.81" target="#fig_9">14</ref>). A rule has been added to detect the circles by looking for the letter "O" and then disambiguate it in the context of the letter. A large "O" in the center of a ringsystem can be interpreted as an aromatic ringsystem. Sending all objects to the OCR module can introduce more noise recognizing letters instead of bonds. For the I2S task the aromatic ring rule has been switched off.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.">Results</head><p>From the 1000 total unique structures 656 structures have been recalled as a perfect match.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0" coords="4,68.16,228.22,48.24,10.54;4,512.16,328.30,43.42,10.54;4,512.16,342.22,42.53,10.54;4,498.96,220.78,47.92,10.54;4,412.32,427.90,35.26,10.54;4,412.32,441.82,39.36,10.54;4,412.32,455.50,28.00,10.54;4,163.68,219.82,22.61,10.54;4,163.68,233.50,36.72,10.54;4,163.68,247.42,31.44,10.54;4,242.64,219.82,29.33,10.54;4,242.64,233.50,35.20,10.54;4,242.64,247.42,35.28,10.54;4,412.32,220.54,24.56,10.54;4,147.36,329.26,29.98,10.54;4,147.36,343.18,33.34,10.54;4,325.68,427.90,23.20,10.54;4,325.68,442.06,48.72,10.54;4,420.48,329.26,20.62,10.54;4,420.48,343.18,40.67,10.54;4,243.12,329.26,43.97,10.54;4,243.12,342.94,43.97,10.54;4,243.12,356.86,4.00,10.54;4,325.68,220.54,29.33,10.54;4,325.68,234.22,34.06,10.54;4,325.68,248.14,4.00,10.54;4,64.32,191.25,56.04,8.64;4,73.44,290.13,60.37,8.64;4,496.56,299.25,59.88,8.64;4,158.40,433.65,42.14,8.64;4,334.32,329.26,23.44,10.54;4,334.32,343.18,47.87,10.54;4,95.04,355.90,43.42,10.54;4,95.04,369.82,23.39,10.54;4,215.76,373.42,34.54,10.54;4,215.76,387.34,35.87,10.54;4,388.56,256.54,39.60,10.54;4,284.64,256.54,44.40,10.54;4,518.16,366.70,43.97,10.54;4,518.16,380.62,41.33,10.54;4,251.76,426.22,38.62,10.54;4,251.76,440.14,39.60,10.54;4,251.76,453.82,38.56,10.54;5,71.28,89.84,117.84,10.82;5,71.28,104.50,473.01,10.81;5,71.28,119.14,352.75,10.81;5,71.28,148.40,44.41,10.82;5,71.28,163.06,369.34,10.81;5,71.28,192.32,178.82,10.82;5,71.28,207.22,473.01,10.81;5,71.28,221.86,473.01,10.81;5,71.28,236.50,426.58,10.81;5,71.28,265.76,126.01,10.82;5,71.28,280.42,473.01,10.81;5,71.28,295.06,473.01,10.81;5,71.28,309.70,54.39,10.81"><head></head><label></label><figDesc>Necessary Step. It extracts the connected components from the image. In detail here will be grouped all foreground pixels which are 8--connected into a component. Tag Text Necessary Step. It identifies connected components that map to text areas. OCR (Optical Character Recognition) Necessary Step. It converts the bitmap letters which are tagged into characters using OCR software. The used software depends on the configuration of the INI file. The internal OCR module is used by default. Some letters may be rejected by the OCR as non--characters. Compute Local Directions Necessary Step. It computes the local directions of segment clusters, i.e. searches for ascending, descending, horizontal and vertical lines in the bitmap image. This is a necessary step for the vectorizer.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1" coords="5,71.28,427.11,330.57,8.00;5,71.33,320.35,266.80,97.43"><head>Figure 2 :</head><label>2</label><figDesc>Figure 2: Example image from the USPTO set. In this image 3 thick chirals will be tagged.</figDesc><graphic coords="5,71.33,320.35,266.80,97.43" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2" coords="6,316.32,231.51,227.21,8.00;6,316.32,242.55,227.11,8.00;6,316.32,253.59,227.20,8.00;6,316.32,264.63,227.32,8.00;6,316.32,275.67,119.28,8.00;6,346.88,112.83,164.19,109.46"><head>Figure 3 ;</head><label>3</label><figDesc>Figure 3; Example image from the USPTO set. In this image the triple bond is drawn in the same orientation as the neighboring single bonds. This is a typical case where a new rule is to be added to the expert system. As this is not a standard way in drawing them.</figDesc><graphic coords="6,346.88,112.83,164.19,109.46" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3" coords="7,316.32,246.39,227.20,8.00;7,316.32,257.43,225.17,8.00"><head>Figure 4 :</head><label>4</label><figDesc>Figure 4: Example image from the USPTO set. In this image a dotted chiral is identified in the five--membered ring.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4" coords="7,71.28,662.55,390.82,8.00;7,153.48,565.65,175.40,87.82"><head>Figure 5 :</head><label>5</label><figDesc>Figure 5: Example images from the USPTO set showing different drawing styles for bridged ring systems.</figDesc><graphic coords="7,153.48,565.65,175.40,87.82" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5" coords="8,71.28,248.55,472.27,8.00;8,71.28,259.59,45.69,8.00;8,267.11,145.12,112.75,94.83"><head>Figure 6 ;</head><label>6</label><figDesc>Figure 6; Example images from the USPTO set. In these images different superatoms like SO2Cl, COOH or BR(CH2)2 have to be recognized.</figDesc><graphic coords="8,267.11,145.12,112.75,94.83" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6" coords="8,71.28,488.07,466.02,8.00;8,71.28,510.08,93.97,10.82;8,71.28,524.98,473.02,10.81;8,71.28,539.62,473.02,10.81;8,71.28,554.26,113.41,10.81;8,71.28,584.00,90.88,10.82;8,71.28,598.66,473.01,10.81;8,71.28,613.30,473.02,10.81;8,71.28,627.94,178.72,10.81;8,71.28,657.20,82.01,10.82;8,71.28,671.86,473.01,10.81;8,71.28,686.50,321.05,10.81;8,98.61,350.94,168.34,128.68"><head>Figure 7 :</head><label>7</label><figDesc>Figure 7: Example images from the USPTO set. In these images captions like Example or Intermediate have to be recognized. Assemble Captions Necessary Step. It selects groups of characters which can be captions of the image or the molecules. These captions will only be added to the molecule if the selected molecule file format supports them. Assemble Charges Necessary Step. It selects negative and positive charges and tries to add them to the appropriate atom. Delocalized charges will only be added to the molecule if the selected molecule file format supports them. Create Molecule Necessary Step. Finally the resulting molecule will be assembled from the different parts. The following workflow modules will modify this molecule further on.</figDesc><graphic coords="8,98.61,350.94,168.34,128.68" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7" coords="9,71.28,212.79,472.30,8.00;9,71.28,223.83,186.23,8.00;9,216.13,130.11,180.66,73.46"><head>Figure 8 :</head><label>8</label><figDesc>Figure 8: Example image from the USPTO set. In this image HCL is removed or written in another molecule by the split fragments or the delete small fragments module.</figDesc><graphic coords="9,216.13,130.11,180.66,73.46" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8" coords="11,71.28,183.51,231.76,8.00;11,71.28,194.55,63.15,8.00;11,110.46,71.33,151.50,108.75"><head>Figure 13 ;</head><label>13</label><figDesc>Figure 13; Images containing Markush elements like repetition units.</figDesc><graphic coords="11,110.46,71.33,151.50,108.75" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_9" coords="11,311.76,177.99,231.75,8.00;11,311.76,189.03,157.37,8.00;11,396.75,104.29,59.25,60.00"><head>Figure 14 ;</head><label>14</label><figDesc>Figure 14; Examples containing aromatic ringsystems. It is unclear where to place the double bonds.</figDesc><graphic coords="11,396.75,104.29,59.25,60.00" type="bitmap" /></figure>
		</body>
		<back>
			<div type="annex">
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.">Problems elements in the USPTO images</head><p>Several problems within the image set that have been identified but not tackled:</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Drawing defects</head><p>The input quality of the scanned image plays a great role for the image recognition. Typical problems are image noise (speckles, disrupted lines), grey level images with antialiasing, watermarks, different backgrounds and overlapping or fused objects. In the training and test sets occur only overlapping objects (cf. figure <ref type="figure" coords="10,264.24,234.82,5.15,10.81">9</ref>). All images are already binarized. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Unclear semantics</head><p>For the typical bonds (like single bonds, double bonds, …) all drawing tools use similar drawing primitives (simple thin lines). Some times dotted lines, thick lines or wavy lines are used to display e.g. hydrogen bonds, metal bonds, attachment points or aromatic bonds. There is no convention in the drawing style. Some examples can be found in the next figure.   Superatoms can be displayed as an acronym (e.g. Boc Butyloxycarbonyl group), a sum formula (C8H17), some kind of line notation (e.g. COOH). It is not always clear how the atoms are connected. Especially if the superatom has more than one attachment point (e.g. amino acids) the correct orientation can only be guessed. chemoCR has only a limited number of predefined superatoms, which will be replaced in an arbitrary position as long as the valences are correct.</p><p>Major problems for image reconstruction tools are Markush elements like repetition elements, variable attachment points, variable ring sizes and R--group elements. There is no standard file format that can represent all kind of Markush elements that can be found in patents. There is a first prototype of chemoCR that can identify some Markush elements. This has not been used in TREC because the I2S task was defined not to contain them.</p></div>			</div>
			<div type="references">

				<listBibl>

<biblStruct coords="12,87.84,92.74,456.45,10.81;12,71.28,107.38,473.01,10.81;12,71.28,122.02,337.50,10.81" xml:id="b0">
	<analytic>
		<title level="a" type="main" coord="12,467.70,92.74,76.59,10.81;12,71.28,107.38,172.49,10.81">Reconstruction of chemical molecules from images</title>
		<author>
			<persName coords=""><forename type="first">M</forename><forename type="middle">E</forename><surname>Algorri</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><surname>Zimmermann</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">C</forename><surname>Friedrich</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">S</forename><surname>Akle</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><surname>Hofmann--Apitius</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m" coord="12,261.94,107.38,282.36,10.81;12,71.28,122.02,300.48,10.81">Proceedings of the 29th Annual International Conference of the IEEE Engineering in Medicine and Biology Society EMBC</title>
		<meeting>the 29th Annual International Conference of the IEEE Engineering in Medicine and Biology Society EMBC</meeting>
		<imprint>
			<date type="published" when="2007">2007</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="12,94.47,136.66,449.83,10.81;12,71.28,151.30,473.01,10.81;12,71.28,165.94,157.19,10.81" xml:id="b1">
	<analytic>
		<title level="a" type="main" coord="12,377.35,136.66,166.95,10.81;12,71.28,151.30,34.41,10.81">Automatic recognition of chemical images</title>
		<author>
			<persName coords=""><forename type="first">M</forename><forename type="middle">E</forename><surname>Algorri</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><surname>Zimmermann</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><surname>Hofmann--Apitius</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m" coord="12,127.78,151.30,416.51,10.81;12,71.28,165.94,54.42,10.81">Eighth Mexican International Conference on Current Trends in Computer Science (ENC 2007)</title>
		<imprint>
			<date type="published" when="2007">2007</date>
			<biblScope unit="page" from="41" to="46" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="12,88.94,180.58,455.36,10.81;12,71.28,195.22,473.01,10.81;12,71.28,210.10,30.07,10.81" xml:id="b2">
	<analytic>
		<title level="a" type="main" coord="12,137.38,180.58,201.69,10.81">Optical recognition of chemical graphics</title>
		<author>
			<persName coords=""><forename type="first">S</forename><surname>Boyer</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m" coord="12,359.28,180.58,185.01,10.81;12,71.28,195.22,333.89,10.81">Document Analysis and Recognition, Proceedings of the Second International Conference on Publication</title>
		<imprint>
			<date type="published" when="1993-10-22">20-22 Oct 1993</date>
			<biblScope unit="page" from="627" to="631" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="12,87.43,224.74,446.84,10.81" xml:id="b3">
	<monogr>
		<title level="m" type="main" coord="12,167.28,224.74,228.42,10.81">M´aramaros k¨oz 3/a, Budapest, 1037 Hungary</title>
		<author>
			<persName coords=""><forename type="first">Chemaxon</forename><surname>Ltd</surname></persName>
		</author>
		<imprint>
			<publisher>Marvin Developer&apos;s Guide</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="12,87.90,239.38,456.39,10.81;12,71.28,254.02,473.01,10.81;12,71.28,268.66,148.76,10.81" xml:id="b4">
	<monogr>
		<title level="m" type="main" coord="12,136.58,239.38,407.71,10.81;12,71.28,254.02,292.06,10.81">Entwicklung und Implementierung einer Protokoll--Datenbank zur Automatisierung elementarer Funktionen von chemoCR. bachelor thesis</title>
		<author>
			<persName coords=""><forename type="first">C</forename><surname>Haupt</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2007">2007</date>
			<pubPlace>Fachhochschule Bonn--Rhein--Sieg, Fachbereich Informatik</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="12,91.85,283.30,452.45,10.81;12,71.28,297.94,451.14,10.81" xml:id="b5">
	<analytic>
		<title level="a" type="main" coord="12,117.11,297.94,262.40,10.81">Chemical literature data extraction: The CLiDE project</title>
		<author>
			<persName coords=""><forename type="first">P</forename><surname>Ibison</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><surname>Jacquot</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">F</forename><surname>Kam</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><forename type="middle">G</forename><surname>Neville</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">R</forename><forename type="middle">W</forename><surname>Simpson</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">C</forename><surname>Tonnelier</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">T</forename><surname>Venczel</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><forename type="middle">P</forename><surname>Johnson</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j" coord="12,384.58,297.94,25.72,10.81">JCICS</title>
		<imprint>
			<biblScope unit="volume">33</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="338" to="344" />
			<date type="published" when="1993">1993</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="12,90.40,312.58,453.89,10.81;12,71.28,327.22,393.66,10.81" xml:id="b6">
	<monogr>
		<title level="m" type="main" coord="12,132.96,312.58,411.33,10.81;12,71.28,327.22,157.61,10.81">Chemical structure recognition via an expert system guided graph exploration. Diploma thesis in bioinformatics</title>
		<author>
			<persName coords=""><forename type="first">P</forename></persName>
		</author>
		<imprint>
			<date type="published" when="2007">2007</date>
			<pubPlace>Munich</pubPlace>
		</imprint>
		<respStmt>
			<orgName>Ludwig--Maximilians--University</orgName>
		</respStmt>
	</monogr>
</biblStruct>

<biblStruct coords="12,89.28,341.86,455.02,10.81;12,71.28,356.50,106.98,10.81" xml:id="b7">
	<analytic>
		<title level="a" type="main" coord="12,246.88,341.86,259.58,10.81">Kekule: Ocr--optical chemical (structure) recognition</title>
		<author>
			<persName coords=""><forename type="first">R</forename><surname>Mcdaniel</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">J</forename><forename type="middle">R</forename><surname>Balmuth</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j" coord="12,513.43,341.86,25.72,10.81">JCICS</title>
		<imprint>
			<biblScope unit="volume">32</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="373" to="378" />
			<date type="published" when="1992">1992</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="12,97.72,415.06,446.58,10.81;12,71.28,429.70,361.10,10.81" xml:id="b8">
	<monogr>
		<title level="m" type="main" coord="12,168.96,415.06,375.33,10.81;12,71.28,429.70,64.43,10.81">Graph--Rekonstruktion im Rahmen chemischer Strukturrepräsentationen. Diplomarbeit</title>
		<author>
			<persName coords=""><forename type="first">L</forename><forename type="middle">T</forename><surname>Bui</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Thi</forename></persName>
		</author>
		<imprint>
			<date type="published" when="2005">2005</date>
			<pubPlace>Würzburg</pubPlace>
		</imprint>
		<respStmt>
			<orgName>Bayerische Julius--Maximilians--Universität</orgName>
		</respStmt>
	</monogr>
</biblStruct>

<biblStruct coords="12,99.88,444.34,444.41,10.81;12,71.28,458.98,473.01,10.81;12,71.28,473.62,334.39,10.81" xml:id="b9">
	<analytic>
		<title level="a" type="main" coord="12,496.83,444.34,47.46,10.81;12,71.28,458.98,473.01,10.81;12,71.28,473.62,50.55,10.81">Information extraction in the life sciences: Perspectives for medicinal chemistry, pharmacology and toxicology</title>
		<author>
			<persName coords=""><forename type="first">M</forename><surname>Zimmermann</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">J</forename><surname>Fluck</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">L</forename><forename type="middle">T</forename><surname>Bui Thi</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">C</forename><surname>Kolrik</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">K</forename><surname>Kumpf</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><surname>Hofmann</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j" coord="12,126.88,473.62,185.75,10.81">Current Topics in Medicinal Chemistry</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="page" from="785" to="796" />
			<date type="published" when="2005">2005</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="12,96.10,488.26,448.19,10.81;12,71.28,502.90,473.01,10.81;12,71.28,517.54,162.46,10.81" xml:id="b10">
	<analytic>
		<title level="a" type="main" coord="12,370.85,488.26,173.44,10.81;12,71.28,502.90,305.98,10.81">Combating illiteracy in chemistry: Towards computer--based chemical structure reconstruction</title>
		<author>
			<persName coords=""><forename type="first">M</forename><surname>Zimmermann</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">C</forename><forename type="middle">M</forename><surname>Friedrich</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><forename type="middle">E</forename><surname>Algorri</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m" coord="12,400.86,502.90,143.43,10.81;12,71.28,517.54,89.79,10.81">1st German Conference on Chemoinformatics</title>
		<meeting><address><addrLine>Goslar</addrLine></address></meeting>
		<imprint>
			<date type="published" when="2005">2005</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="12,95.05,532.18,449.24,10.81;12,71.28,546.82,284.96,10.81" xml:id="b11">
	<monogr>
		<title level="m" type="main" coord="12,308.52,532.18,235.77,10.81;12,71.28,546.82,171.06,10.81">Automated extraction of chemical information from chemical structure depictions</title>
		<author>
			<persName coords=""><forename type="first">M</forename><surname>Zimmermann Andm. Hofmann--Apitius</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2007">2007</date>
		</imprint>
	</monogr>
	<note>touch briefings</note>
</biblStruct>

<biblStruct coords="12,93.79,561.46,450.50,10.81;12,71.28,576.10,402.83,10.81" xml:id="b12">
	<analytic>
		<title level="a" type="main" coord="12,333.13,561.46,211.16,10.81;12,71.28,576.10,248.76,10.81">Combating illiteracy in chemistry: Towards computer--based chemical structure reconstruction</title>
		<author>
			<persName coords=""><forename type="first">M</forename><surname>Zimmermann</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">L</forename><forename type="middle">T</forename><surname>Bui Thi</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><surname>Hofmann</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j" coord="12,325.19,576.10,60.93,10.81">ERCIM News</title>
		<imprint>
			<biblScope unit="volume">60</biblScope>
			<biblScope unit="page" from="40" to="41" />
			<date type="published" when="2005">2005</date>
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
