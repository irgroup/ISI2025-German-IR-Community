<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main" coord="1,170.93,87.95,270.14,14.93;1,188.72,109.86,234.56,14.93">Performance of MolRec at TREC 2011 Overview and Analysis of Results</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName coords="1,170.64,142.18,103.30,10.37"><forename type="first">Noureddin</forename><forename type="middle">M</forename><surname>Sadawi</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">School of Computer Science</orgName>
								<orgName type="institution">University of Birmingham</orgName>
							</affiliation>
						</author>
						<author>
							<persName coords="1,282.37,142.18,68.40,10.37"><forename type="first">Alan</forename><forename type="middle">P</forename><surname>Sexton</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">School of Computer Science</orgName>
								<orgName type="institution">University of Birmingham</orgName>
							</affiliation>
						</author>
						<author role="corresp">
							<persName coords="1,379.15,142.18,62.20,10.37"><forename type="first">Volker</forename><surname>Sorge</surname></persName>
							<email>sorge@cs.bham.ac.uk</email>
							<affiliation key="aff0">
								<orgName type="department">School of Computer Science</orgName>
								<orgName type="institution">University of Birmingham</orgName>
							</affiliation>
						</author>
						<author>
							<persName coords="1,173.43,197.10,97.92,8.42"><forename type="first">N</forename><forename type="middle">M P</forename><surname>Sadawi|a</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">School of Computer Science</orgName>
								<orgName type="institution">University of Birmingham</orgName>
							</affiliation>
						</author>
						<author>
							<persName coords="1,278.33,197.10,55.95,8.42"><surname>Sexton|v</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">School of Computer Science</orgName>
								<orgName type="institution">University of Birmingham</orgName>
							</affiliation>
						</author>
						<title level="a" type="main" coord="1,170.93,87.95,270.14,14.93;1,188.72,109.86,234.56,14.93">Performance of MolRec at TREC 2011 Overview and Analysis of Results</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="MD5">69CFBF185611DF13C773EA3CC6D7B415</idno>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.8.0" ident="GROBID" when="2024-08-05T15:06+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>Chemical molecular diagrams are commonly found in documents from the chemical and life science disciplines. We present an overview of the elements of these diagrams and of MolRec, our system for analysing and recognising them. MolRec uses a number of techniques to refine the scanned images and precisely detect line segments and line junctions, structural elements and the atomic formulae that commonly appear in such diagrams. The output of our system is a chemical formula and associated MOL file, a standard representation of molecular structures used in cheminformatics that records precise molecular spatial and connectivity information. When applied to the TREC 2011 test set of 1000 molecular diagrams, MolRec returned in two separate runs 949 and 950 correctly recalled structures, respectively. We discuss these results and present an analysis of MolRec's performance on the test set.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<facsimile>
		<surface n="1" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="2" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="3" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="4" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="5" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="6" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="7" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="8" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
	</facsimile>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Overview of Diagram Elements</head><p>Molecular diagrams generally consist of a combination of characters denoting names of atoms (e.g., O) or more complex molecules (e.g., HO) together with graphical elements depicting chemical bonds. The latter can be of a number of different types and their combination determines the overall 3-dimensional structure of the entire molecule.</p><p>An overview of the different common types of bonds is given in Figure <ref type="figure" coords="1,135.05,594.21,3.74,8.64" target="#fig_0">1</ref>. One or more normal line segments are used to show normal bonds (planar bonds) as in Figures 1(a), 1(b) and 1(c). Parallel line segments close together where each is of approximately the average bond length indicate a double (or triple) bond. Parallel line segments where at least some are shorter than the others indicate a sequence of separate bonds with an omitted carbon atom at the node, called an implicit node, identified by the end of the shorter line segments, as in Figure <ref type="figure" coords="1,165.57,689.85,3.74,8.64" target="#fig_1">2</ref>.</p><p>To indicate 3-dimensional structure of molecular diagrams, bonds are drawn in different styles to indicate a direction with respect to the drawing surface. These styles de- The solid wedge, hollow wedge or bold line segment, in Figures <ref type="figure" coords="1,349.86,558.19,11.45,8.64" target="#fig_0">1(d</ref>), 1(e) and 1(f) respectively, are used to show bonds coming out of the plane of the drawing surface (towards the viewer). The direction of the solid and hollow wedge bonds is determined by the tip-to-base direction, meaning the stereo-centre is at the narrow end. In the bold bond case both direction and stereo-centre are unspecified and have to be determined somehow, for example by using chemical domain knowledge, for a correct recognition of the diagram.</p><p>A dashed wedge, a dashed line segment and a dashed bold line segment, Figures <ref type="figure" coords="1,408.72,678.17,11.45,8.64" target="#fig_0">1(g</ref>), 1(h) and 1(i) respectively, are used to depict bonds going behind the plane of the drawing surface (away from the viewer). These also have directions to specify the stereo-centre. For a dashed wedge bond, the stereo-centre is at the shortest dash, so the direction is from the shortest to the longest dash. For a dashed bond and bold bond, the direction and stereo-centre are unspecified and have to be identified. A wavy bond, as in Figure <ref type="figure" coords="2,172.47,293.80,3.38,8.64" target="#fig_0">1</ref>(j), is used to show an unspecified configuration (mixture of up and down).</p><p>As Figure <ref type="figure" coords="2,109.45,317.71,4.15,8.64" target="#fig_0">1</ref>(k) shows, an arrow is used to illustrate a dative (polar) bond. The direction of the arrow is from sourceto-head and it indicates the existence of a negatively charged atom at the head of the arrow.</p><p>Further 3-dimensional structure can be depicted with bridge bonds, in case there are multiple different connection paths between different parts of the molecule. These are typically presented in a 2 1 /2-dimensional perspective drawing form. Such diagrams have one or more foreground bonds drawn crossing one or more background bonds, where foreground and background bonds are not connected where they appear to touch in the diagram. If the background bond is drawn with a gap to make this clear, it is called an open bridge bond, otherwise it is called a closed bridge bond (c.f. Figure <ref type="figure" coords="2,103.73,485.08,3.60,8.64" target="#fig_3">3</ref>).  Aromatic rings are sometimes drawn with a large circle inside a cycle of bonds, as in Figure <ref type="figure" coords="2,209.23,678.17,3.74,8.64" target="#fig_4">4</ref>, instead of separate planar bonds.</p><p>Superatoms are names that are embedded in a diagram as if it were an atom (c.f. Figure <ref type="figure" coords="2,185.20,714.03,3.60,8.64" target="#fig_5">5</ref>). These names represent whole molecular substructures that can have multiple bonds  </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Implementation</head><p>MolRec's recognition procedure consists of a series of steps, of which we present the most important ones in this section.</p><p>After initial binarisation of the input image, connected components are labelled and fed into a simple metric space based OCR engine to identify character symbols, which are subsequently combined into character groups. Then we recognise bonds based on a rule set for rewriting basic graphical elements. This forms the basis of a graph structure, which can be translated into the MOL output format, after embedding of superatoms and further resolution of ambiguous stereo bonds.</p><p>A full specification of our rule set for bond recognition as well as a more detailed description of the entire recognition procedure can be found in <ref type="bibr" coords="2,422.47,576.65,10.58,8.64" target="#b5">[6]</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Character Grouping</head><p>Letters, numerals and some symbols are taken to indicate atoms or superatoms. Any such components identified during the OCR process are grouped to form labels. Grouping is performed horizontally, vertically and diagonally.</p><p>Let a and b be elements of N ∪ L ∪ S, where N is the set of digits, L the set of letters and S the set of non-letter, non-digit symbols. If a and b are within a preset distance of each other, a will be grouped horizontally, vertically or diagonally with b as follows:</p><p>Horizontal grouping is performed if the spatial relations between a and b is horizontal and one of the following conditions holds: i) Both a and b are letters ii) Both a and b are digits iii) a is a letter and b is a symbol, or vice versa.</p><p>Vertical grouping is performed if the spatial relations between a and b is vertical and: i) Both a and b are letters Diagonal grouping is performed if the spatial relations between a and b is diagonal and one of the following conditions holds: i) a is a letter and b is a digit, or vice versa.</p><p>ii) a is a letter and b is a charge sign, or vice versa. The top character group of Figure <ref type="figure" coords="3,123.09,523.53,4.01,8.64" target="#fig_6">6</ref>(a) shows a letter to the right of a symbol "(C", a letter to the right of another letter "CH", a digit to the bottom right of a letter "H 2 ", a symbol to the top right of a digit " 2 )", a digit to the bottom right of a symbol ") 1 " and a digit to the right of another digit "16". Also, these rules will not allow grouping of very close characters such as the ones shown in Figure <ref type="figure" coords="3,127.33,595.26,3.82,8.64" target="#fig_6">6</ref>(b), 6(c) and 6(d). The example shown in Figure <ref type="figure" coords="3,96.93,607.21,3.71,8.64" target="#fig_6">6</ref>(e), which is not entirely clear even to a human reader, is not disambiguated by the previous rules.</p><p>Some cases requiring disambiguation include the uppercase letter "O", lower case "l", upper case "I", etc.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">Line Finding and Recognition of Bonds</head><p>Any detected character groups are erased from the image and the new image is thinned to unit width thickness. The line segments, which can be free standing or connected as polylines, are traversed and split at junctions where more than 2 line segments join. An average line width is calculated during this stage. This results in a set of polylines that is used as input to the Douglas-Peucker line simplification algorithm <ref type="bibr" coords="3,351.13,96.65,10.58,8.64" target="#b0">[1]</ref>. The result of using this algorithm is a set of straight line segments and an average line length.</p><p>Parallel line segments indicating double or triple bonds or bond sequences with implicit nodes are all identified by clustering line segments of the same slope that are within a threshold distance of each other. In the bond sequence case, the long line segments are split at the points where the short line segments end, so that a node to hold the implied atom is created.</p><p>A sequence of short parallel line segments spaced apart at regular distances are detected by identifying short line segments whose centre points are regularly spaced within a certain tolerance. A sequence of short parallel line segments of monotonically changing length represent a dashed wedge where the stereo-centre is identified as the atom at the shortest line segment of the wedge, while short line segments of similar length represent a dashed bold bond. A more direct approach based on using their slope is not reliable because of the difficulty of accurately finding the slope of such short line segments. Dashed bonds are detected by identifying repeated short line segments of similar length whose centre points are collinear. Again, the stereo-centre in the case of dashed bold bond and dashed bond is unknown. Our method for identifying the stereo-centre is explained in section 3.1.</p><p>To extract precise geometric information about bonds in the shape of solid wedges, we use a disk of a radius larger than a measured average line thickness. The measured thickness is obtained dynamically by analysing discovered lines in the image. This disk can fit inside the base of a wedge (triangle) but not in a normal line. We grow the disk until it reaches the largest size possible while still covering only foreground pixels in the original image. Then we walk the position of the disk in any direction that allows it to continue to grow. If this object is indeed a wedge, then when it can grow no more we have found the base of the triangle, thus identifying the stereo-centre for this 3D bond. We can then walk the disk along in the direction of slowest decrease of disk size to find the opposite end of the bond. If it is not a triangle, then the disk size will not change appreciably over the length of the thinned line segment corresponding to this connected component. In this case we recognise the object as a thick solid line segment (c.f. Figure <ref type="figure" coords="3,481.07,597.25,3.60,8.64">7</ref>), but in this case the stereo-centre in unknown, and we just need to identify the two end points (more on this in section 3.1).</p><p>Figure <ref type="figure" coords="3,359.77,723.83,3.88,8.64">7</ref>: Using Disk to Identify Wedge/Bold Bonds Wavy bonds, which are drawn as a wave pattern, are reduced by our thinning and line simplification process to a sawtooth pattern polyline of connected short line segments. This is straightforward to identify when following the polyline.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3">Graph Construction</head><p>At this stage, an initial undirected graph is constructed where each bond is an edge and each junction is a node. This is done by grouping line segment endpoints by distance and by connectivity to the bounding box of character groups in order to construct each node. Each vertex of the graph is labelled with the character group at the corresponding position. Bonds and character groups in the graph are examined for common causes of ambiguity. Disambiguation of lower case "l", upper case "I", the digit "1" and a vertical single bond is carried out at this point.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.4">Superatom Embedding</head><p>We mined MOL files in the OSRA dataset <ref type="bibr" coords="4,240.60,317.71,10.58,8.64" target="#b1">[2]</ref>, and integrated the freely available Marvin abbreviation group collection superatom dictionary <ref type="bibr" coords="4,162.75,341.62,11.62,8.64" target="#b3">[4]</ref> to identify complete information about superatoms. Superatoms in MOL file structures identify the superatoms in situ, marking each atom of the whole structure that belongs to the superatom, together with the internal bonds in the superatom and the external bonds between the superatom and the surrounding structure. We then replace the superatom nodes in the graph with an embedding of the structure of the superatom.</p><p>This still leaves us with the connection permutation problem, but at least gives us unambiguous internal connection information and identification of the connecting atoms.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.5">Stereo Bond Resolution</head><p>For 3D-bonds with unknown stereochemistry, as in Figure <ref type="figure" coords="4,288.56,512.41,3.74,8.64" target="#fig_7">8</ref>, MolRec needs to decide the stereo nature of the bond, i.e. which side of the bond is the stereo-centre, and, in the case of the wavy bond, whether the direction of the bond is towards the background or the foreground of the image. The syntax of the diagram does not give sufficient information to resolve this correctly so, in the absence of better domain knowledge, we employ a number of heuristics based on observed patterns in diagrams we have analysed. heuristics use information about the numbers of neighbours on each end of the bond in question.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.6">Output Generation</head><p>Finally, the MOL file <ref type="bibr" coords="4,406.28,318.70,11.62,8.64" target="#b7">[8]</ref> is generated from the graph. For training and evaluation, we used OpenBabel <ref type="bibr" coords="4,496.96,330.65,11.62,8.64" target="#b4">[5]</ref> which provides the ability to compare different MOL files semantically, ignoring unimportant syntactic differences.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Analysis of MolRec's Performance</head><p>When run twice on the 1000 images in the TREC11 data set, MolRec achieved a 95% and a 94.9% correct recovery rate, respectively. This corresponds to 50 diagrams misrecognised in the first run, and 51 in the second. In fact, because most of the diagrams mis-recognised in the first were also mis-recognised in the second, where the internal parameters in MolRec were slightly adjusted, there were a total of 55 different diagrams mis-recognised in one or other of the two runs. Some of these 55 diagrams failed for multiple reasons, so we were able to identify 61 reasons for diagram recognition failures in total. Table <ref type="table" coords="4,350.66,551.15,4.98,8.64" target="#tab_0">1</ref> summarises the reasons for failed recognition together with the exact number of mis-recognised images for each reason. In the remainder of this section we discuss each of the cases with some suggestions for future improvements.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Incorrect Stereochemistry</head><p>The stereochemistry of some bonds is not derivable purely from the syntactic properties of the diagram and, in the absence of deeper domain knowledge, our use of heuristics reduces the number of incorrect choices of 3D bond direction but does not eliminate them. When our heuristics guessed the wrong stereochemistry in such cases, a mis-recognition occurs. Adding further domain knowledge should improve recognition rate here.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Solid Circles without 3D Hydrogen Bond</head><p>A number of diagrams in the test set use the solid circle notation that indicates a 3D Hydrogen bond, but without that stereo bond information appearing in the solution MOL files. This seems to be a particularity of some of the samples in the test set, an issue that is further discussed in section 4. Mol-Rec's results always generates the stereo bond information in its output MOL files and thus does not match the solution MOL files in these cases.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3">Touching Components</head><p>MolRec does not currently handle touching components such as in Figure <ref type="figure" coords="5,126.98,221.95,3.74,8.64" target="#fig_8">9</ref>. These can include:</p><p>• Touching characters, although MolRec handles ligatures such as NH (where the serifs touch).</p><p>• Letters touching symbols</p><p>• Characters touching bonds, although MolRec handles the common pattern where a diagonal bond is glued to a character from the bottom.</p><p>• Some cases of bonds accidentally touching bonds, usually due to ink bleed between close parallel lines making a connection that should not be there. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.4">Broken Characters</head><p>MolRec does not currently handle broken characters such as in Figure <ref type="figure" coords="5,97.31,582.02,8.30,8.64" target="#fig_9">10</ref>. As with touching characters this is a known difficult problem in document analysis. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.6">Connectivity of Superatoms</head><p>If there are two or more bonds between the superatom and the surrounding structure, it is sometimes unclear how to determine the appropriate permutation of connection possibilities to match the actual chemical structures in question. MolRec essentially makes a random guess as to the correct permutation, and therefore gets in wrong in some cases. Again, additional knowledge on the structure of superatoms could reduce this problem.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.7">Problematic Bridge Bonds</head><p>MolRec detects open bridge bonds when a broken straight line with another straight line passing through the gap are found. The broken line is reconnected. Closed bridge bonds are identified by checking the crossing junctions and checking that the lines forming the junction are part of irregularly shaped cycles.</p><p>Non-bridge bond cycles are always regularly shaped pentagons, hexagons etc. MolRec detects such irregularities by finding junction angles outside expected ranges and interprets the structure accordingly. However, in some cases in the test set, either the angles involved were outside the thresholds used by MolRec or the perspective was sufficiently extreme that MolRec confused which node should be associated with certain line segment endings. Figure <ref type="figure" coords="6,286.07,242.19,9.96,8.64" target="#fig_3">13</ref> presents two such examples. Here further fine tuning of our recognition approach is needed. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.8">Unhandled Bond Type</head><p>The dashed dative bond is shown in Figure <ref type="figure" coords="6,230.73,507.44,8.30,8.64" target="#fig_12">14</ref>. We have not encountered such a symbol before and are not clear about its intended interpretation. The solution MOL file interprets it as a planar single bond. Since MolRec's bond recognition </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.9">Unrecognised Syntax</head><p>We classified a total of five images as possessing a syntax unrecognised by MolRec. Three images in the dataset included user annotations (c.f. Figure <ref type="figure" coords="6,364.53,117.25,7.89,8.64" target="#fig_5">15</ref>). The corresponding solution MOL files do not appear to treat them as part of the structure. In the case of Figure <ref type="figure" coords="6,354.59,141.16,19.59,8.64" target="#fig_5">15(c)</ref>, the solution MOL file uses a Carbon atom in place of the question mark symbol, i.e. it ignores the symbol.   While it is unlikely that one can devise a recognition procedure that can take care of arbitrary user annotations, we are hopeful that at least regular Markush structures <ref type="bibr" coords="7,261.24,84.70,10.58,8.64" target="#b2">[3]</ref>, such as the above frequency variations, could be handled within our rule based approach.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.10">Dashed Wedge Bonds Mis-Identified</head><p>These include incorrect identification of some dashed wedge bonds and of some bridge bonds. For the dashed wedge bonds in question, the short dashes at the narrow end of the bond were considered by MolRec as part of a dashed bond, while the longer dashes were treated as part of a dashed wedge, or dashed bold, bond. This has led to interpreting some dashed wedge bonds as two connected bonds (a dashed bond and a dashed wedge, or dashed bold, bond), which meant an extra non-existent node and bond were added. Further honing MolRec's recognition parameters should take care of this problem in the future.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.11">Diagram Caption Confusion</head><p>On 5 images in the test set a diagram caption appears in the image (c.f. Figure <ref type="figure" coords="7,134.40,334.05,7.89,8.64" target="#fig_16">18</ref>). As MolRec is aimed to recognise molecule structures only, it does not do any image segmentation. Consequently it fails to recognise the image because it cannot find a suitable interpretation for the caption as part of the molecule structure. We have not found a definitive graphical syntax specification for molecular diagrams, and it is clear that there exist diagrams which use some graphical elements in different and inconsistent ways from each other. Also there appear to be syntactic notations in these diagrams that do not give sufficient information on their own to uniquely determine the corresponding MOL file up to isomorphism. Finally there are many diagrams to be found in the literature which contain definite errors.</p><p>In such cases, it is a difficult choice for a molecular diagram recognition system as to what it should, or could, do.</p><p>Here we consider the few cases of this nature in the TREC11 test set. Solid Circles: The test set contains several structures with a solid circle covering a junction. We understand these solid circles to indicate the existence of a hydrogen atom connected to that node via a solid wedge bond (c.f. Figure <ref type="figure" coords="7,539.53,121.15,7.89,8.64" target="#fig_17">19</ref>), an interpretation borne out by the corresponding MOL files in the solution set for a number of diagrams with such solid circles in the test set. However, some images in the test set have the solid circle but the provided solution MOL file indicates that the node in question does not have the corresponding solid wedge bond to a hydrogen atom, e.g. US06372153-20020416-C02522.</p><p>MolRec recognises and interprets these solid circles in the way we believe correct. However, for the problem cases described above, MolRec obviously produces MOL files that do not match the solution MOL file.   Although a MolRec's 95% recognition rate in TREC 2011 is already high, there is still plenty of room for improvement. Some of the mis-recognition problems we faced are inherently uncorrectable, in the sense that, just like in the real world, some of the test cases either have errors or have incorrect solution MOL files. Such problems must simply be accepted. We believe many of the mis-recognition problems can be solved with some relatively simple enhancements of our system, e.g. the 15 dashed wedge bond misidentifications or the 5 diagram caption confusion cases. For a significant number of the problems we need to incorporate more chemical domain knowledge into our system, e.g. for the 10 incorrect stereochemistry problems or the 3 superatom connectivity problems.</p><p>Overall, we are pleased that a number of approaches turned out to be very successful and we recommend them to any who work in this field: Line finding and simplification: Early experiments using Hough transforms for line finding yielded disappointing results with poor robustness. Instead we start with connected component analysis, filter characters using OCR on each connected component, skeletonise the remaining components, and use the Douglas-Peucker algorithm to simplify the skeletons and remove skeletonisation artifacts, in order to produce clean paths along lines. We can then walk the lines in the original image using the cleaned skeletons to detect and analyse the various types of bonds. This approach has proven to be fast and particularly successful.</p><p>Solid triangle and bold line detection: Given our cleaned skeleton paths, we identify and orient solid triangles, and simultaneously detect bold lines, by finding components within which a disk of radius larger than the line width can fit, and then walking the disk along the direction of the component that allows maximal growth in the disk (or minimal shrinkage). This has also proven to be very fast and robust.</p><p>Mining superatoms in MOL files: Unavailability of comprehensive superatom dictionaries, and the lack of the level of detail of internal information about the superatoms that are necessary for use in MOL files, led us to mine collections of MOL files for their superatom content. This was a fairly simple process of extracting the superatom definitions from the MOL files and relabelling their contents so that they could be reused in other MOL files. This has significantly increased the number of diagrams we can recognise automatically, although we still face the open problem of connectivity permutations in superatoms which have more than one external connections from different internal atoms.</p><p>Breaking joints: Many joints in a molecular diagram touch end-to-end to indicate the presence of an unmentioned Carbon atom. However, often Carbon atoms are explicitly written in to a space separating the bond lines. Rather than have to deal with the combinatorial possibilities of the various ways that bonds might connect, we chose to explicitly break all such connected joints so that we could treat them all in a uniform way. This has significantly simplified our code and the logic for dealing with connections and has yielded unexpected dividends in, to name one example, dealing with implicit nodes such as in Figure <ref type="figure" coords="8,445.48,417.45,3.74,8.64" target="#fig_1">2</ref>.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0" coords="1,359.22,500.95,152.83,8.64"><head>Figure 1 :</head><label>1</label><figDesc>Figure 1: Common Bond Conventions</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1" coords="2,56.69,215.29,239.34,8.64;2,56.69,227.24,42.05,8.64;2,177.61,132.13,99.73,53.54"><head>Figure 2 :</head><label>2</label><figDesc>Figure 2: Implicit Nodes (indicated by shaded disks) in Bond Sequences</figDesc><graphic coords="2,177.61,132.13,99.73,53.54" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3" coords="2,93.60,642.98,165.53,8.64;2,72.91,541.29,99.72,71.97"><head>Figure 3 :</head><label>3</label><figDesc>Figure 3: Closed and Open Bridge Bonds</figDesc><graphic coords="2,72.91,541.29,99.72,71.97" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4" coords="2,386.22,148.45,98.84,8.64"><head>Figure 4 :</head><label>4</label><figDesc>Figure 4: Aromatic Ring</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5" coords="2,394.38,342.41,82.51,8.64;2,398.24,249.85,74.79,77.13"><head>Figure 5 :</head><label>5</label><figDesc>Figure 5: Superatom</figDesc><graphic coords="2,398.24,249.85,74.79,77.13" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6" coords="3,121.42,488.00,109.89,8.64;3,66.66,511.57,229.38,8.64;3,56.69,523.53,239.34,8.64;3,56.69,535.16,239.34,8.96;3,56.69,547.12,239.34,9.65;3,56.69,559.07,239.35,9.65;3,56.69,571.03,239.34,8.96;3,56.69,583.30,239.34,8.64;3,56.69,595.26,239.34,8.64;3,56.69,607.21,239.34,8.64;3,56.69,619.17,199.96,8.64;3,66.66,631.12,229.38,8.64;3,56.69,643.08,200.85,8.64;3,97.84,382.55,64.82,75.84"><head>Figure 6 :</head><label>6</label><figDesc>Figure 6: Character Groups Some examples are shown in Fig 6. The top character group of Figure6(a) shows a letter to the right of a symbol "(C", a letter to the right of another letter "CH", a digit to the bottom right of a letter "H 2 ", a symbol to the top right of a digit " 2 )", a digit to the bottom right of a symbol ") 1 " and a digit to the right of another digit "16". Also, these rules will not allow grouping of very close characters such as the ones shown in Figure6(b), 6(c) and 6(d). The example shown in Figure6(e), which is not entirely clear even to a human reader, is not disambiguated by the previous rules. Some cases requiring disambiguation include the uppercase letter "O", lower case "l", upper case "I", etc.</figDesc><graphic coords="3,97.84,382.55,64.82,75.84" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7" coords="4,79.47,664.77,193.78,8.64;4,72.91,581.78,64.83,53.37"><head>Figure 8 :</head><label>8</label><figDesc>Figure 8: Bonds with Unknown Stereochemistry</figDesc><graphic coords="4,72.91,581.78,64.83,53.37" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8" coords="5,87.22,476.19,178.29,8.64;5,66.66,499.31,229.38,8.64;5,56.69,511.27,239.34,8.64;5,56.69,523.22,71.71,8.64;5,177.61,394.31,74.80,52.27"><head>Figure 9 :</head><label>9</label><figDesc>Figure 9: Example of Touching Components While a number of solutions have been proposed in the literature to handle touching characters, this problem is notoriously difficult.</figDesc><graphic coords="5,177.61,394.31,74.80,52.27" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_9" coords="5,92.69,712.66,167.34,8.64;5,97.84,619.58,99.73,63.47"><head>Figure 10 :</head><label>10</label><figDesc>Figure 10: Example of Broken Characters</figDesc><graphic coords="5,97.84,619.58,99.73,63.47" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_10" coords="5,365.60,664.43,140.06,8.64"><head>Figure 12 :</head><label>12</label><figDesc>Figure 12: Example of Superatoms</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_11" coords="6,65.79,427.12,221.15,8.64;6,72.91,291.74,99.73,105.66"><head></head><label></label><figDesc>Figure 13: Problematic Closed and Open Bridge Bonds</figDesc><graphic coords="6,72.91,291.74,99.73,105.66" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_12" coords="6,112.90,685.08,126.93,8.64;6,126.50,568.94,99.73,100.70"><head>Figure 14 :</head><label>14</label><figDesc>Figure 14: Dashed Dative Bond</figDesc><graphic coords="6,126.50,568.94,99.73,100.70" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_13" coords="6,349.56,375.62,172.15,8.64;6,397.00,283.61,74.79,62.39"><head></head><label></label><figDesc>Figure 15: Unrecognised User Annotations</figDesc><graphic coords="6,397.00,283.61,74.79,62.39" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_14" coords="6,347.71,597.25,175.86,8.64;6,385.77,518.42,99.73,63.40"><head>Figure 16 :</head><label>16</label><figDesc>Figure 16: Unrecognised Wavy Line Syntax</figDesc><graphic coords="6,385.77,518.42,99.73,63.40" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_15" coords="6,371.27,723.83,128.73,8.64"><head>Figure 17 :</head><label>17</label><figDesc>Figure 17: Repetition Structures</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_16" coords="7,109.65,537.28,133.43,8.64;7,64.18,399.92,224.38,121.93"><head>Figure 18 :</head><label>18</label><figDesc>Figure 18: Diagram with Caption</figDesc><graphic coords="7,64.18,399.92,224.38,121.93" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_17" coords="7,344.32,358.26,182.62,8.64;7,322.20,277.38,109.70,51.17"><head>Figure 19 :</head><label>19</label><figDesc>Figure 19: These two notations are equivalent</figDesc><graphic coords="7,322.20,277.38,109.70,51.17" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_18" coords="7,373.27,677.00,124.72,8.64;7,398.24,603.38,74.81,58.18"><head>Figure 20 :</head><label>20</label><figDesc>Figure 20: Dative (Polar) Bond</figDesc><graphic coords="7,398.24,603.38,74.81,58.18" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_19" coords="8,56.69,342.37,239.34,8.64;8,76.64,216.46,199.46,110.48"><head>Figure 21 :</head><label>21</label><figDesc>Figure 21: Circled carbon atoms have 5 bonds and no charge</figDesc><graphic coords="8,76.64,216.46,199.46,110.48" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" coords="4,272.24,59.59,271.29,675.03"><head>Table 1 :</head><label>1</label><figDesc>Reasons for Mis-Recognition of Molecules.</figDesc><table coords="4,272.24,725.99,23.79,8.64"><row><cell>These</cell></row></table></figure>
		</body>
		<back>
			<div type="references">

				<listBibl>

<biblStruct coords="8,331.40,470.39,223.91,7.77;8,331.40,481.35,223.91,7.77;8,331.40,492.15,176.33,7.94" xml:id="b0">
	<analytic>
		<title level="a" type="main" coord="8,439.17,470.39,116.14,7.77;8,331.40,481.35,223.91,7.77;8,331.40,492.31,34.17,7.77">Algorithms for the reduction of the number of points required to represent a digitized line or its caricature</title>
		<author>
			<persName coords=""><forename type="first">D</forename><surname>Douglas</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">T</forename><surname>Peucker</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j" coord="8,372.21,492.15,51.37,7.73">Cartographica</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="112" to="122" />
			<date type="published" when="1973">1973</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="8,331.40,503.27,223.91,7.77;8,331.40,514.23,223.91,7.77;8,331.40,525.02,189.91,7.93" xml:id="b1">
	<analytic>
		<title level="a" type="main" coord="8,434.46,503.27,120.85,7.77;8,331.40,514.23,223.91,7.77;8,331.40,525.19,27.68,7.77">Optical structure recognition software to recover chemical information: OSRA, an open source solution</title>
		<author>
			<persName coords=""><forename type="first">I</forename><surname>Filippov</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><surname>Nicklaus</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j" coord="8,365.77,525.02,71.43,7.73">J. Chem. Inf. Model</title>
		<imprint>
			<biblScope unit="volume">49</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="740" to="743" />
			<date type="published" when="2009">2009</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="8,331.40,535.98,223.90,7.93;8,331.40,546.94,223.91,7.93;8,331.40,558.06,123.52,7.77" xml:id="b2">
	<analytic>
		<title level="a" type="main" coord="8,381.73,535.98,173.57,7.73;8,331.40,546.94,38.25,7.73">Handbook of Chemoinformatics: From Data to Knowledge</title>
		<author>
			<persName coords=""><forename type="first">J</forename><surname>Gasteiger</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m" coord="8,378.05,547.10,177.26,7.77;8,331.40,558.06,49.84,7.77">Advances in Electrochemical Sciences and Engineering Series</title>
		<imprint>
			<publisher>Wiley-VCH</publisher>
			<date type="published" when="2003">2003</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="8,331.40,569.02,169.42,7.77;8,517.65,569.86,37.66,6.31;8,331.40,580.82,220.57,6.31;8,331.40,591.78,195.91,6.31" xml:id="b3">
	<monogr>
		<ptr target="http://atchimiebiologie.free.fr/marvin/chemaxon/marvin/templates/default.abbrevgroup" />
		<title level="m" coord="8,331.40,569.02,166.00,7.77">The Marvin abbreviation group collection</title>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct coords="8,331.40,601.90,223.90,7.77;8,331.40,613.70,99.08,6.31" xml:id="b4">
	<monogr>
		<ptr target="http://www.openbabel.org/" />
		<title level="m" coord="8,331.40,601.90,177.30,7.77">Open Babel: The open source chemistry toolbox</title>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct coords="8,331.40,623.82,223.91,7.77;8,331.40,634.61,223.91,7.93;8,331.40,645.57,223.90,7.93;8,331.40,656.69,25.64,7.77" xml:id="b5">
	<analytic>
		<title level="a" type="main" coord="8,462.66,623.82,92.65,7.77;8,331.40,634.77,105.67,7.77">Chemical structure recognition: A rule based approach</title>
		<author>
			<persName coords=""><forename type="first">N</forename><surname>Sadawi</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><surname>Sexton</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">V</forename><surname>Sorge</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m" coord="8,454.50,634.61,100.81,7.73;8,331.40,645.57,91.35,7.73">19th Document Recognition and Retrieval Conference</title>
		<imprint>
			<publisher>SPIE</publisher>
			<date type="published" when="2012-01">2012. January 2012</date>
		</imprint>
	</monogr>
	<note>to appear</note>
</biblStruct>

<biblStruct coords="8,331.40,667.65,63.86,7.77;8,413.18,667.65,142.14,7.77;8,331.40,678.61,50.58,7.77;8,399.29,679.45,156.02,6.31;8,331.40,690.41,99.08,6.31" xml:id="b6">
	<monogr>
		<title level="m" type="main" coord="8,413.18,667.65,142.14,7.77;8,331.40,678.61,19.43,7.77">Chembiodraw v12.0 user documentation</title>
		<author>
			<persName coords=""><forename type="first">Cambridge</forename><surname>Soft</surname></persName>
		</author>
		<ptr target="http://www.cambridgesoft.com/software/ChemDraw/" />
		<imprint>
			<date type="published" when="2010">2010</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="8,331.40,700.53,223.90,7.77;8,331.40,712.33,185.15,6.31" xml:id="b7">
	<monogr>
		<title level="m" type="main" coord="8,362.14,700.53,51.03,7.77">CTfile formats</title>
		<author>
			<persName coords=""><surname>Symyx</surname></persName>
		</author>
		<ptr target="http://www.symyx.com/downloads/public/ctfile/ctfile.jsp" />
		<imprint>
			<date type="published" when="2010">2010</date>
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
