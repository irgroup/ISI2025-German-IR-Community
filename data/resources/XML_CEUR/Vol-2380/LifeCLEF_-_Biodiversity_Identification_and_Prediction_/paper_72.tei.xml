<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main" coord="1,143.95,115.96,327.45,12.62;1,243.88,133.89,127.59,12.62">Plant recommendation using environment and biotic associations</title>
				<funder ref="#_NAqAtb7">
					<orgName type="full">French Agence Nationale de la Recherche</orgName>
					<orgName type="abbreviated">ANR</orgName>
				</funder>
				<funder>
					<orgName type="full">French Research Institute for digital sciences (INRIA)</orgName>
				</funder>
				<funder ref="#_ZK6qZFK">
					<orgName type="full">French National Institute of Agricultural Research (INRA)</orgName>
				</funder>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author role="corresp">
							<persName coords="1,141.08,171.70,64.62,8.74"><forename type="first">Sara</forename><surname>Si-Moussi</surname></persName>
							<email>sara.si-moussi@inra.fr</email>
							<affiliation key="aff0">
								<orgName type="department" key="dep1">Eco&amp;Sols</orgName>
								<orgName type="department" key="dep2">IRD</orgName>
								<orgName type="laboratory">CIRAD</orgName>
								<orgName type="institution" key="instit1">Univ Montpellier</orgName>
								<orgName type="institution" key="instit2">INRA</orgName>
								<address>
									<addrLine>Montpellier SupAgro</addrLine>
									<postCode>F-34398</postCode>
									<settlement>Montpellier</settlement>
									<country key="FR">France</country>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="laboratory">LECA</orgName>
								<orgName type="institution" key="instit1">University Grenoble Alpes</orgName>
								<orgName type="institution" key="instit2">CNRS</orgName>
								<orgName type="institution" key="instit3">Univ. Savoie Mont Blanc</orgName>
								<orgName type="institution" key="instit4">CNRS</orgName>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="laboratory">Laboratoire d&apos;Ecologie Alpine</orgName>
								<address>
									<postCode>F38000</postCode>
									<settlement>Grenoble</settlement>
									<country key="FR">France</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName coords="1,316.16,171.70,63.65,8.74"><forename type="first">MickaÃ«l</forename><surname>Hedde</surname></persName>
							<affiliation key="aff0">
								<orgName type="department" key="dep1">Eco&amp;Sols</orgName>
								<orgName type="department" key="dep2">IRD</orgName>
								<orgName type="laboratory">CIRAD</orgName>
								<orgName type="institution" key="instit1">Univ Montpellier</orgName>
								<orgName type="institution" key="instit2">INRA</orgName>
								<address>
									<addrLine>Montpellier SupAgro</addrLine>
									<postCode>F-34398</postCode>
									<settlement>Montpellier</settlement>
									<country key="FR">France</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName coords="1,234.82,183.66,73.40,8.74"><forename type="first">Wilfried</forename><surname>Thuiller</surname></persName>
							<affiliation key="aff1">
								<orgName type="laboratory">LECA</orgName>
								<orgName type="institution" key="instit1">University Grenoble Alpes</orgName>
								<orgName type="institution" key="instit2">CNRS</orgName>
								<orgName type="institution" key="instit3">Univ. Savoie Mont Blanc</orgName>
								<orgName type="institution" key="instit4">CNRS</orgName>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="laboratory">Laboratoire d&apos;Ecologie Alpine</orgName>
								<address>
									<postCode>F38000</postCode>
									<settlement>Grenoble</settlement>
									<country key="FR">France</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main" coord="1,143.95,115.96,327.45,12.62;1,243.88,133.89,127.59,12.62">Plant recommendation using environment and biotic associations</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="MD5">64B7742098B3B8B495DCE2896C56B14C</idno>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.8.0" ident="GROBID" when="2024-06-26T15:59+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>Distributed representations</term>
					<term>Convolutional neural networks</term>
					<term>Species distribution models</term>
					<term>Ecological niche theory</term>
					<term>Plant ecology</term>
				</keywords>
			</textClass>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>Automatically predicting species make-up in geographic locations is of great importance in the context of the current conversation about biodiversity. Inspired by the ecological concepts of Grinnellian and Eltonian niches, we investigate two neural network architectures that aim to that aim to exploit the respective features of these two types of niches in order to tackle the plant recommendation task. The first proposal uses environmental rasters and leverages advanced feature extraction techniques based on distributed representations and convolutional neural networks. The second proposal relies on neighboring co-occurrences of plants and organisms from an expert-curated list of taxa. We find that the former solution outperforms the latter in prediction accuracy, yet the second solution provides interesting and more interpretable indicators. Both approaches yield promising results on the GeoLifeCLEF 2019 challenge.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<facsimile>
		<surface n="1" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="2" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="3" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="4" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="5" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="6" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="7" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="8" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="9" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="10" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="11" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="12" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
		<surface n="13" ulx="0.0" uly="0.0" lrx="612.0" lry="792.0"/>
	</facsimile>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>Predicting the most likely species in a given location is of great importance in biodiversity studies. This age-old task in biogeography consists in learning a density function of the species over the geographic space from a set of observed geolocalized occurrences. In practice, due to sampling bias, limited examples and local habitat heterogeneity, geographic coordinates are not used directly as predictors. Instead, species abundance is modeled as a function of the environmental conditions at the given locations. Such models are called Species Distribution Models (SDMs) or Habitat Suitability Models (HSMs).</p><p>The local environment is usually described by abiotic features such as climate and pedology. Recently, more studies include biotic covariates in the form of other living beings abundance, motivated by the need to account for the dependencies between species that can affect their co-distributions. Indeed, two species distributions may be correlated indirectly through a latent abiotic variable or directly if they interact in some way that creates a dependency between their respective populations as in the case of plant-pollinators, host-parasites, predator-preys, etc.</p><p>The set of locations with suitable abiotic conditions for a given species define its Grinnellian niche <ref type="bibr" coords="2,242.56,262.46,12.32,8.74" target="#b5">[6]</ref>. On the other hand, the role it occupies within its community through feeding on other organisms or interacting with them defines its Eltonian niche <ref type="bibr" coords="2,209.95,286.37,12.82,8.74" target="#b4">[5]</ref> or its biotic requirements. The locations at the intersection between the two niches constitute the species' Fundamental niche. What we observe is an accessible subset of it called the Realized niche <ref type="bibr" coords="2,391.11,310.28,14.61,8.74" target="#b13">[14]</ref>.</p><p>In the context of the GeoLifeCLEF 2019 challenge, part of the LifeCLEF evaluation campaign <ref type="bibr" coords="2,220.56,346.14,13.70,8.74" target="#b7">[8]</ref>, we evaluate two models on location-based plant recommendation. The first one relies purely on abiotic features while the second harnesses regional level co-occurrences of the target species with other organisms selected with expert assistance. We describe both solutions and discuss results obtained during training, validation and test phases.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Dataset description</head><p>The task organizers provided a training dataset containing about 280K observations from the Global Biodiversity and Information Facility database. Nearly 2M plant occurrences from automatic species identification of pictures produced in 2017-2018 by the smartphone application Pl@ntNet were added. We used the complete provided plant occurrences involving almost 3.5K plant taxa. Besides, 10M occurrences from other biodiversity kingdoms were also included. Finally, 33 environmental rasters covering the French territory were provided. They describe the climate, topology and pedological landscape. They were constructed from various open datasets as explained in the protocol note <ref type="bibr" coords="2,402.12,540.51,9.96,8.74" target="#b1">[2]</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Task and proposals</head><p>The task consists in training a model that predicts at a geographic location the dominant plant species. We formulate this task as a multi-class classification problem where the output class is the dominant plant identity. We evaluate two architectures for solving the task:</p><p>-GrinnellNet: A convolutional neural network architecture using environmental rasters. It aims to learn features of species Grinnellian niche.</p><p>-EltonNet: A species embedding network leveraging associations with nearest non-plant taxa occurrences. Its purpose is to identify community composition patterns that are positively associated with a specific plant species, possibly related to the Eltonian niche concept.</p><p>Hereafter, we describe both proposals and motivate our architecture, preprocessing and optimization choices.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">GrinnellNet: a CNN with categorical rasters embedding</head><p>GrinnellNet's architecture (illustrated in Figure <ref type="figure" coords="3,352.30,235.33,4.43,8.74">1</ref>) is organized in a stack of components trained end-to-end: input preprocessing, feature extraction, feature interaction and classification. It takes environmental rasters as inputs and returns the identity of the dominant plant for each location.</p><p>Input preprocessing Observing a species in a given location does not necessarily imply the suitability of the abiotic environment. Indeed, some species survive in locations with unfavorable conditions (known as sink locations) as long as new individuals continuously join the population from a nearby suitable habitat (source locations), through seed dispersal for instance via wind currents. These so called source-sink dynamics <ref type="bibr" coords="3,295.79,360.45,10.52,8.74" target="#b6">[7]</ref> ensure an indefinite sustainability of the sink populations despite unfavorable abiotic conditions. Consequently, failing to account for these spatial processes may result in overestimation of the species' environmental niche's breadth. In addition to the effects of such stochastic assembly processes, the geographic coordinates provided by smartphone devices come with measurement errors, which represent a further source of uncertainties that need to be accounted for.</p><p>For these reasons, it is necessary to consider a landscapewise rather than a pointwise description of the environment around the observation geolocation by using environmental patches instead of local values.</p><p>We divide the environmental rasters into three groups based on their semantic, the resolution at which they vary and their data type (quantitative, ordinal and categorical).</p><p>-TopoHydroClimate group: quantitative variables describing global bioclimate (CHBIO, ETP), hydrology (water proximity) and topology (altitude). -Pedology group: ordinal and categorical variables describing the physicochemical structure of the soil. -Land use group: includes Corine Land Cover class.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Embedding categorical features</head><p>Part of the soil's physico-chemical properties are described by categorical or pseudo-ordinal features such as texture, land cover, erodibility and crusting class. Therefore, for each of the f c categorical features, before feeding it to the CNN ]. In practice, this is implemented by a feature-specific embedding lookup layer parameterized by a (n c , f c ) matrix E c , such that E c [i, ] is the k c sized embedding of the i th value of f c . We apply this transformation batchwise in parallel to all patch cells (light grey module in Figure <ref type="figure" coords="5,354.09,178.77,3.87,8.74">1</ref>). For an input of dimension (batchSize, patchRadius, patchRadius, 1), the embedding layer of f c returns a (batchSize, patchRadius, patchRadius, k c ) tensor. These vector representations are trained along with other network parameters.</p><p>Categorical embeddings capture richer relationships than raw categories. They are also considered as a dimensionality reduction technique, more practical than one-hot-encoding when dealing with high-cardinality yet sparse features (a typical example in our case is land cover). Note that each embedding dimension could have multiple meanings that do not necessarily line up with ordinal dimensions. In the end, categories with similar representations translate a similar effect on the target variable.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Resulting preprocessed inputs</head><p>Pedological features embeddings resulting from the previous step are concatenated into a single tensor of dimension: (batchSize, patchRadius, patchRadius, d c ) s.t d c = câC k c (brown module in Figure <ref type="figure" coords="5,324.38,373.98,3.87,8.74">1</ref>). C refers to the set of categorical features. In our case, d c = 18. Land cover is embedded separately (khaki box in Figure <ref type="figure" coords="5,166.20,397.89,3.87,8.74">1</ref>). Handling spatial data requires to use appropriate feature extraction techniques that are able to harness the spatial structure of such inputs. Convolutional neural networks <ref type="bibr" coords="5,227.92,632.21,17.48,8.74" target="#b9">[10]</ref>, a class of artificial neural networks inspired from the virtual cortex of animals, constitute an ideal choice as they allow to extract features from spatially-structured inputs within an end-to-end learning process.</p><p>They have been previously shown to provide substantial improvements in predicting species abundance <ref type="bibr" coords="6,250.83,130.95,10.52,8.74" target="#b0">[1,</ref><ref type="bibr" coords="6,261.35,130.95,7.01,8.74" target="#b3">4]</ref>.</p><p>Each of our CNN-based feature extraction modules comprises a two-block architecture similar to VGG <ref type="bibr" coords="6,247.82,166.81,20.55,8.74" target="#b15">[16]</ref>. Each block contains two 3Ã3 convolution layers set to extract 256 features, followed by MaxPooling then a Leaky Rectified Linear Unit activation. The latter function choice prevents the model from falling into a dying ReLu problem (experienced during first tests with ReLu activation) <ref type="bibr" coords="6,460.27,202.68,16.26,8.74" target="#b10">[11]</ref>. Retained embedding sizes, patch radius and resulting number of channels are shown in the detailed architecture are provided in the source code.</p><p>Feature interaction and classification components Extracted features from the different components are flattened and eventually concatenated into a single large vector. This vector is then fed into a fully connected neural network dedicated to learning the separation of the plant classes in the learnt feature space. This feature interaction component (green box in Figure <ref type="figure" coords="6,417.22,303.73,4.43,8.74">1</ref>) comprises 3 dense layers of respectively 8192, 4096 and 3353 neurons. We applied a 0.75 dropout rate on the intermediary layers to prevent overfitting. The classification layer consists on a softmax activation applied on the output to determine the probabilities of each class. Class probabilities sum to one by definition. Naturally, the class with the highest probability is attributed to the instance.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">EltonNet: a species embedding network</head><p>Here we propose to rely purely on associations between plants and other taxonomic groups. The goal is to predict the dominant plant from knowledge of the occurrences of other taxa around it, up to a certain radius. In order to reduce the number of co-occurring organisms, address the rarity of some of them and capture stronger associations with plants, the following processing steps were applied to the records of non-plant occurrences.</p><p>Taxonomic grouping and biogeographical filtering We aggregated taxa according to ecological knowledge on the taxonomic level where biogeographical correlations to plants are meaningful. This level differs from one group to another, thus different preprocessing schemes were applied to different taxonomic groups. Then, for some groups we used domain-knowledge heuristics to filter irrelevant groups. Proportions of retained groups in the taxa list are illustrated in Figure <ref type="figure" coords="6,179.01,573.00,3.87,8.74" target="#fig_2">2</ref>. Finally, we assigned internal codes, i.e. unique identifiers, to each group.</p><p>Fungi selection . We grouped fungal species by genus. Then, we used the Fun-GUILD database <ref type="bibr" coords="6,207.03,620.25,17.91,8.74" target="#b12">[13]</ref> to select fungi from guilds (groups with similar diets and functions in the ecosystem) that are dependent on plants for feeding. We kept the following guilds: Pathotrophs (parasites of plants) and Symbiotrophs (involved in positive associations with plants such as mycchorizea). We deleted Saprotrophs (organic matter decomposers) as they do not depend on plants whatsoever. In the end, we retained 195 out of 531 genuses.</p><p>Insects selection . We aggregated insects to the order level except for Coleoptera and Orthoptera which were grouped in families as they exhibit significant intraorder variability in terms of habitat preferences and diet. We chose among insect orders those with known co-evolution history with plants (such as Hymenoptera) and/or established potential for direct interaction with plants (such as pollinators and herbivores) <ref type="bibr" coords="7,260.26,216.04,16.63,8.74" target="#b14">[15]</ref>. The intuition is that some insects have strong affinities or preferences (such as specialist pollinators) towards specific plants which leads to a greater chance of co-existence. This process led to the selection of 464 families of Coleoptera and Orthoptera in addition to 9 other orders.</p><p>Aves selection . Most birds breed in their preferential habitat during the period spanning from March to July. The rest of the year, during their migration phase, they travel through other areas where they can occasionally be observed. We considered these observations as spurious and removed them to avoid establishing false associations to plants. We then aggregated birds to the genus level. Afterwards, we used www.oiseaux.net to identify and remove some introduced/invasive genuses. We ended up with 240 bird taxa.</p><p>Amphibians, mammals and reptiles aggregation . Lacking expert knowledge on these phyla, we simply grouped them to the genus level, yielding 21 amphibians, 93 mammals, and 33 reptiles. Biotic context calculation To accelerate the training phase, we precomputed for each training example i, given its coordinates, the set V i of non plant observations that occur within a radius of at most 8 Km. Starting with 500m, we iteratively doubled the radius until we identified a non-empty set of neighbor species, up until at most 8km. Afterwards, we randomly draw with repetition w observations from V i with a uniform probability. That way, more abundant taxa (present multiple times in V i ) have a higher probability of being included. At the end of this process, we had associated each training example to its biotic context made of w observations of organisms from other kingdoms.</p><p>The species embedding network architecture The learning model used is an adaptation of the Continuous Bag of Words model first introduced in <ref type="bibr" coords="8,462.33,255.51,14.61,8.74" target="#b11">[12]</ref>. The architecture, illustrated in Figure <ref type="figure" coords="8,301.77,267.47,3.87,8.74" target="#fig_3">3</ref>, is based on a neural network composed of 3 layers:</p><p>-The input layer of size W receives the identifiers of the biotic context components.</p><p>-An embedding layer that associates a real-valued vector of size k np for each taxa (non plants). This embedding vector captures the effect of observing this organism on the odds of each plant class.</p><p>-A lambda averaging layer that aggregates the biotic context embeddings.</p><p>-A dense layer that computes for each target plant species the dot products of its weight vector to the aggregated context embedding. This layer uses a softmax activation to return the probabilities of each target plant to occur given the observations of the surrounding non plants. <ref type="bibr" coords="8,134.77,440.45,6.72,10.52" target="#b3">4</ref> Training and evaluation</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1">Optimization and evaluation metrics</head><p>Given: -P : the set of plant classes (here species-level identifications).</p><p>-c: the expected or true class.</p><p>-s c : the neural network output probability for the true class.</p><p>-w c : weight of the true class.</p><p>In both proposals, we optimize the class-weighted sparse categorical crossentropy loss given by equation Eq 1</p><formula xml:id="formula_0" coords="8,251.05,582.24,229.54,28.14">CE = -w c log( exp sc P j exp sj )<label>(1)</label></formula><p>Some species were observed more often than others leading to a class-imbalance problem within the training set. To address this issue, we weighted each training example by the weight of its expected class (see Eq 2). This strategy allowed us to give more importance to the misclassification of rare classes observations (correcting for false negatives). Each class c with a frequency of occurrence p c on the training set was attributed a weight computed as the ratio of its points of absence to its points of presence.</p><formula xml:id="formula_1" coords="9,281.13,493.29,199.46,23.23">w c = 1 -p c p c<label>(2)</label></formula><p>This process is particularly useful for endemic species of undersampled locations.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.2">Implementation and learning setting</head><p>We implemented GrinnellNet and EltonNet in Python 4 using Keras deep learning framework with Tensorflow 5 backend. We trained the models using multigpu data parallelism on a single computing node equiped with 4 GPUS V100 with NVlink 6 . We used adam optimization algorithm[9] with a decaying learning rate starting from 0.001 and reduced by a 10 factor whenever the validation loss stops improving after 5 epochs.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.3">Evaluation</head><p>We sampled 80% of the dataset for training and kept the remaining 20% for validation. We used a stratified cross-validation split procedure to ensure coverage of all classes in the training set. At the end of every epoch, we evaluated the prediction accuracy of the models on the validation set. Figure <ref type="figure" coords="10,420.91,229.95,4.98,8.74" target="#fig_4">4</ref> summarizes the performances obtained during training (left axis) along with results on test set (right axis). Note that different evaluation metrics are used. As a result, we can only compare the models ranking.</p><p>ELT100 and ELT300 correspond to EltonNet applied to occurrences of test species (evaluated in the test set) with the embedding size parameter k np set respectively to 100 and 300. GRIN SEP and GRIN SEP+ (trained longer) apply GrinnellNet on occurrences of all plant species whereas in GRIN SEP TEST the model is trained only on test species. GRIN SEP uses separate feature extraction components for each feature group while GRIN JOINT uses the joint feature extraction mode. Unsurprisingly, GrinnellNet performs much better than EltonNet. Indeed, we would expect such results as covariates used in the former are richer and unbiased. Besides, biogeographical theory recognizes the superiority of the abiotic filter in selecting species <ref type="bibr" coords="11,238.30,154.86,11.73,8.74" target="#b2">[3]</ref>, as it is directly related to their physiological traits. On the other hand, EltonNet resulted from a series of arbitrary domain heuristics. Nevertheless, it still performs better than random with relatively strong associations learnt between plants and other taxa, a non-negligible insight for community ecologists.</p><p>In the case of GrinnellNet, the choice of the feature extraction mode clearly affects its predictive performances. Results show that treating the feature groups separately leads to better performances. This can be explained by the nature of the data encoded in the rasters that were created/interpolated from different data collection protocols. Indeed, pedological characteristics for instance are mainly determined by subjective field observations whereas climate data are calculated with advanced mathematical models. Another possible reason to separate the feature extraction processes is the scale at which the rasters were constructed. While bioclimatic variables are interpolated to the kilometer in regular grids, soil data are aggregated using anthropo-topological polygons to the landscape level, which translates in several kilometers. Consequently, we only submitted GRIN SEP runs for the clef challenge.</p><p>We also observed that that the weighting strategy yielded significant performance improvements over the unweighted variant (not shown here). Furthermore, the runs ranking on the validation set is roughly the same as in the test set results except for GRIN SEP and GRIN SEP TEST. During validation, we found that GrinnellNet performs better when it is trained solely on test species than when it uses occurrences of all plant species. At test time, the order was reversed which might be a sign of overfitting in GRIN SEP. But also, because GRIN SEP TEST is exposed to more observations it probably learns more robust features.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">Conclusion</head><p>We presented two proposals for the location-based species recommendation problem. The first solution leverages the concept of Grinnellian niche by building its predictions on only abiotic features, automatically extracted from environmental rasters using convolutional neural networks. This approach can be extended to any taxonomic group beyond plants. Moreover, we investigated the use of distributed representations as a means to reduce feature dimensionality as well as to capture rich semantic associations.</p><p>In the second proposal, we attempted to learn the Eltonian niche of the plants by embedding the biotic contexts where they are observed. We relied heavily on domain knowledge with expert assistance to filter co-occurrences in order to learn strong associations. Although the assumptions and rules used to select non plants species were specific to plant modeling, the learning architecture itself can be used for any taxonomic group. Additionally, this approach suffered from the heterogeneity of the sampling effort. Ideally, one could use projection maps predicted by species distribution models when available as input to a convolutional neural network.</p><p>Overall, our proposed CNN solution outperformed the species embedding approach. But the latter allowed us to identify associations between plants and other taxa which can be used to develop bioindicators. In the end, one could train both models jointly with shared layers that can capture the interactions and possible feedbacks between biotic and abiotic variables.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0" coords="4,242.98,725.61,129.40,7.89;4,186.64,421.68,242.08,268.68"><head></head><label></label><figDesc>Fig. 1. GrinnellNet architecture</figDesc><graphic coords="4,186.64,421.68,242.08,268.68" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1" coords="5,149.71,422.45,330.89,8.74;5,134.77,434.41,345.82,9.65;5,134.77,446.36,212.95,9.65;5,134.77,479.49,345.82,8.77;5,134.77,491.48,88.50,8.74;5,140.99,513.99,339.60,8.77;5,151.70,525.98,265.03,8.74;5,151.70,537.93,170.17,8.74;5,334.04,542.96,14.64,6.12;5,351.33,537.93,129.25,9.65;5,151.70,549.89,221.75,8.74;5,140.99,562.47,339.60,8.77;5,151.70,574.45,328.88,8.74;5,151.70,586.41,144.57,8.74"><head></head><label></label><figDesc>Climate, topological and hydrological features are input to the neural network as batches of (batchSize, patchRadius, patchRadius, d num ) multi-channel images, d num = 22 being the number of features. Feature extraction We investigated two modes of feature extraction on the preprocessed inputs: -JointGrinnellNet: A joint mode where all input tensors are concatenated into a single multi-channel image. The result with dimension (batchSize, patchRadius, patchRadius, câC k c + n num )) is fed into a feature extraction module, as presented in Figure 3.1. -SepGrinnellNet: A separate mode where the three groups of features are treated separately by dedicated feature extraction modules then merged afterwards, as shown in Figure 3.1.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2" coords="7,196.63,632.07,222.10,7.89;7,143.04,430.15,329.28,187.15"><head>Fig. 2 .</head><label>2</label><figDesc>Fig. 2. Non plants taxa proportion in the retained list.</figDesc><graphic coords="7,143.04,430.15,329.28,187.15" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3" coords="9,134.77,373.61,345.82,7.89;9,134.77,384.59,345.83,7.86;9,134.77,395.55,345.82,7.86;9,134.77,406.51,345.83,7.86;9,134.77,417.47,70.32,7.86;9,148.98,115.84,317.40,243.00"><head>Fig. 3 .</head><label>3</label><figDesc>Fig. 3. EltonNet architecture. Each box represents a layer described by its name and type as well as its input and output dimensions. None refers to the undefined batch size. The context size and embedding dimension shown here are respectively w = 50 and knp = 100. The last layer (bottom level) gives the probabilities of each plant class, here 3353 classes.</figDesc><graphic coords="9,148.98,115.84,317.40,243.00" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4" coords="10,136.02,655.03,343.33,7.89;10,134.77,406.89,370.39,233.36"><head>Fig. 4 .</head><label>4</label><figDesc>Fig. 4. Performance of GrinnellNet and EltonNet variants on validation and test set.</figDesc><graphic coords="10,134.77,406.89,370.39,233.36" type="bitmap" /></figure>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="4" xml:id="foot_0" coords="9,144.73,634.88,328.02,7.86"><p>Source code: https://github.com/SoccoCMOS/GeoLifeCLEF2019-GrinnEltonNet</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="5" xml:id="foot_1" coords="9,144.73,645.84,162.52,7.86"><p>https://www.tensorflow.org/guide/keras</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="6" xml:id="foot_2" coords="9,144.73,656.80,238.42,7.86"><p>Ciment cluster, UMS GRICAD, Grenoble Alpes University</p></note>
		</body>
		<back>

			<div type="acknowledgement">
<div><head>Acknowledgments</head><p>The authors would like to thank <rs type="person">Tanguy Daufresne</rs> for considerable guidance in selecting relevant vertebrate taxa and <rs type="person">Esther Galbrun</rs> for comments on draft versions of this document. SS is supported by a <rs type="grantName">joint PhD fellowship</rs> of the <rs type="funder">French National Institute of Agricultural Research (INRA)</rs> and the <rs type="funder">French Research Institute for digital sciences (INRIA)</rs>. The research was also supported by funding from the <rs type="funder">French Agence Nationale de la Recherche (ANR)</rs> through the <rs type="grantName">GlobNets grant</rs> (<rs type="grantNumber">ANR-16-CE02-0009</rs>). All the computations presented in this paper were performed using the GRICAD infrastructure 7 .</p></div>
			</div>
			<listOrg type="funding">
				<org type="funding" xml:id="_ZK6qZFK">
					<orgName type="grant-name">joint PhD fellowship</orgName>
				</org>
				<org type="funding" xml:id="_NAqAtb7">
					<idno type="grant-number">ANR-16-CE02-0009</idno>
					<orgName type="grant-name">GlobNets grant</orgName>
				</org>
			</listOrg>
			<div type="references">

				<listBibl>

<biblStruct coords="12,142.96,445.77,337.64,7.86;12,151.52,456.73,329.07,7.86;12,151.52,467.69,305.63,7.86" xml:id="b0">
	<analytic>
		<title level="a" type="main" coord="12,399.00,445.77,81.60,7.86;12,151.52,456.73,162.15,7.86">A deep learning approach to species distribution modelling</title>
		<author>
			<persName coords=""><forename type="first">C</forename><surname>Botella</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><surname>Joly</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">P</forename><surname>Bonnet</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">P</forename><surname>Monestiez</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">F</forename><surname>Munoz</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m" coord="12,336.25,456.73,144.34,7.86;12,151.52,467.69,182.27,7.86">Multimedia Tools and Applications for Environmental &amp; Biodiversity Informatics</title>
		<imprint>
			<publisher>Springer</publisher>
			<date type="published" when="2018">2018</date>
			<biblScope unit="page" from="169" to="199" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="12,142.96,479.23,337.64,7.86;12,151.52,490.19,329.07,7.86;12,151.52,501.15,71.22,7.86" xml:id="b1">
	<analytic>
		<title level="a" type="main" coord="12,344.01,479.23,136.59,7.86;12,151.52,490.19,246.96,7.86">Overview of geolifeclef 2019: plant species prediction using environment and animal occurrences</title>
		<author>
			<persName coords=""><forename type="first">C</forename><surname>Botella</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><surname>Servajean</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">P</forename><surname>Bonnet</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><surname>Joly</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m" coord="12,420.61,490.19,59.98,7.86;12,151.52,501.15,21.05,7.86">CLEF working notes</title>
		<imprint>
			<date type="published" when="2019">2019</date>
			<biblScope unit="page">2019</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="12,142.96,512.69,337.63,7.86;12,151.52,523.65,329.07,7.86;12,151.52,534.59,151.86,7.89" xml:id="b2">
	<analytic>
		<title level="a" type="main" coord="12,321.42,512.69,159.17,7.86;12,151.52,523.65,324.60,7.86">Accounting for dispersal and biotic interactions to disentangle the drivers of species distributions and their abundances</title>
		<author>
			<persName coords=""><forename type="first">I</forename><surname>Boulangeat</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">D</forename><surname>Gravel</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">W</forename><surname>Thuiller</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j" coord="12,151.52,534.61,59.85,7.86">Ecology letters</title>
		<imprint>
			<biblScope unit="volume">15</biblScope>
			<biblScope unit="issue">6</biblScope>
			<biblScope unit="page" from="584" to="593" />
			<date type="published" when="2012">2012</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="12,142.96,546.16,337.63,7.86;12,151.52,557.11,329.07,7.86;12,151.52,568.07,47.10,7.86" xml:id="b3">
	<analytic>
		<title level="a" type="main" coord="12,342.50,546.16,138.09,7.86;12,151.52,557.11,283.42,7.86">Location-based species recommendation using co-occurrences and environment-geolifeclef 2018 challenge</title>
		<author>
			<persName coords=""><forename type="first">B</forename><surname>Deneu</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><surname>Servajean</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">C</forename><surname>Botella</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><surname>Joly</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m" coord="12,455.89,557.11,24.70,7.86;12,151.52,568.07,18.43,7.86">CLEF 2018</title>
		<imprint>
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="12,142.96,579.62,265.77,7.86" xml:id="b4">
	<monogr>
		<author>
			<persName coords=""><forename type="first">C</forename><forename type="middle">S</forename><surname>Elton</surname></persName>
		</author>
		<title level="m" coord="12,201.82,579.62,59.83,7.86">Animal ecology</title>
		<imprint>
			<publisher>University of Chicago Press</publisher>
			<date type="published" when="2001">2001</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="12,142.96,591.13,337.64,7.89;12,151.52,602.12,25.60,7.86" xml:id="b5">
	<analytic>
		<title level="a" type="main" coord="12,201.97,591.16,192.77,7.86">The niche-relationships of the california thrasher</title>
		<author>
			<persName coords=""><forename type="first">J</forename><surname>Grinnell</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j" coord="12,401.32,591.16,16.89,7.86">Auk</title>
		<imprint>
			<biblScope unit="volume">34</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="427" to="433" />
			<date type="published" when="1917">1917</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="12,142.96,613.66,337.63,7.86;12,151.52,624.60,329.07,7.89;12,151.52,635.58,60.92,7.86" xml:id="b6">
	<analytic>
		<title level="a" type="main" coord="12,198.31,613.66,282.27,7.86;12,151.52,624.62,173.20,7.86">Population dynamics in two-patch environments: some anomalous consequences of an optimal habitat distribution</title>
		<author>
			<persName coords=""><forename type="first">R</forename><forename type="middle">D</forename><surname>Holt</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j" coord="12,330.85,624.62,122.38,7.86">Theoretical population biology</title>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="181" to="208" />
			<date type="published" when="1985">1985</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="13,142.96,119.67,337.64,7.86;13,151.52,130.63,329.07,7.86;13,151.52,141.59,329.07,7.86;13,139.37,152.55,7.17,7.86" xml:id="b7">
	<monogr>
		<title level="m" type="main" coord="13,355.74,130.63,124.85,7.86;13,151.52,141.59,329.07,7.86;13,139.37,152.55,3.58,7.86">Overview of lifeclef 2019: Identification of amazonian plants, south &amp; north american birds, and niche prediction 9</title>
		<author>
			<persName coords=""><forename type="first">A</forename><surname>Joly</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">H</forename><surname>Goau</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">C</forename><surname>Botella</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">S</forename><surname>Kahl</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><surname>Servajean</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">H</forename><surname>Glotin</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">P</forename><surname>Bonnet</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">W</forename><forename type="middle">P</forename><surname>Vellinga</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">R</forename><surname>Planqu</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">F</forename><forename type="middle">R</forename><surname>Stter</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">H</forename><surname>Mller</surname></persName>
		</author>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct coords="13,151.53,152.55,329.06,7.86;13,151.52,163.51,93.19,7.86" xml:id="b8">
	<monogr>
		<title level="m" type="main" coord="13,239.72,152.55,176.61,7.86">Adam: A method for stochastic optimization</title>
		<author>
			<persName coords=""><forename type="first">D</forename><forename type="middle">P</forename><surname>Kingma</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">J</forename><surname>Ba</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1412.6980</idno>
		<imprint>
			<date type="published" when="2014">2014</date>
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct coords="13,142.62,174.47,337.98,7.86;13,151.52,185.40,329.07,7.89" xml:id="b9">
	<monogr>
		<title level="m" type="main" coord="13,270.77,174.47,209.82,7.86;13,151.52,185.43,233.14,7.86">Convolutional networks for images, speech, and time series. The handbook of brain theory and neural networks</title>
		<author>
			<persName coords=""><forename type="first">Y</forename><surname>Lecun</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Y</forename><surname>Bengio</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1995">1995</date>
			<biblScope unit="volume">3361</biblScope>
			<biblScope unit="page">1995</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="13,142.62,196.39,337.98,7.86;13,151.52,207.34,228.86,7.86" xml:id="b10">
	<analytic>
		<title level="a" type="main" coord="13,306.73,196.39,173.87,7.86;13,151.52,207.34,84.08,7.86">Rectifier nonlinearities improve neural network acoustic models</title>
		<author>
			<persName coords=""><forename type="first">A</forename><forename type="middle">L</forename><surname>Maas</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><forename type="middle">Y</forename><surname>Hannun</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><forename type="middle">Y</forename><surname>Ng</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m" coord="13,257.11,207.34,43.92,7.86">Proc. icml</title>
		<meeting>icml</meeting>
		<imprint>
			<date type="published" when="2013">2013</date>
			<biblScope unit="volume">30</biblScope>
			<biblScope unit="page">3</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="13,142.62,218.30,337.98,7.86;13,151.52,229.26,263.42,7.86" xml:id="b11">
	<monogr>
		<author>
			<persName coords=""><forename type="first">T</forename><surname>Mikolov</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">K</forename><surname>Chen</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">G</forename><surname>Corrado</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">J</forename><surname>Dean</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1301.3781</idno>
		<title level="m" coord="13,341.33,218.30,139.26,7.86;13,151.52,229.26,101.88,7.86">Efficient estimation of word representations in vector space</title>
		<imprint>
			<date type="published" when="2013">2013</date>
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct coords="13,142.62,240.22,337.97,7.86;13,151.52,251.18,329.07,7.86;13,151.52,262.11,277.07,7.89" xml:id="b12">
	<analytic>
		<title level="a" type="main" coord="13,235.18,251.18,245.41,7.86;13,151.52,262.14,127.93,7.86">Funguild: an open annotation tool for parsing fungal community datasets by ecological guild</title>
		<author>
			<persName coords=""><forename type="first">N</forename><forename type="middle">H</forename><surname>Nguyen</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">Z</forename><surname>Song</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">S</forename><forename type="middle">T</forename><surname>Bates</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">S</forename><surname>Branco</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">L</forename><surname>Tedersoo</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">J</forename><surname>Menke</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">J</forename><forename type="middle">S</forename><surname>Schilling</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">P</forename><forename type="middle">G</forename><surname>Kennedy</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j" coord="13,286.28,262.14,61.94,7.86">Fungal Ecology</title>
		<imprint>
			<biblScope unit="volume">20</biblScope>
			<biblScope unit="page" from="241" to="248" />
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="13,142.62,273.10,337.98,7.86;13,151.52,284.06,329.07,7.86;13,151.52,295.02,214.99,7.86" xml:id="b13">
	<monogr>
		<author>
			<persName coords=""><forename type="first">A</forename><forename type="middle">T</forename><surname>Peterson</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">J</forename><surname>SoberÃ³n</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">R</forename><forename type="middle">G</forename><surname>Pearson</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">R</forename><forename type="middle">P</forename><surname>Anderson</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">E</forename><surname>Martinez-Meyer</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><surname>Nakamura</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">M</forename><forename type="middle">B</forename><surname>AraÃºjo</surname></persName>
		</author>
		<title level="m" coord="13,291.93,284.06,188.66,7.86;13,151.52,295.02,38.45,7.86">Ecological niches and geographic distributions (MPB-49)</title>
		<imprint>
			<publisher>Princeton University Press</publisher>
			<date type="published" when="2011">2011</date>
			<biblScope unit="volume">56</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="13,142.62,305.98,337.97,7.86;13,151.52,316.93,120.29,7.86" xml:id="b14">
	<monogr>
		<author>
			<persName coords=""><forename type="first">N</forename><surname>Sauvion</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">P</forename><forename type="middle">A</forename><surname>Calatayud</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">D</forename><surname>ThiÃ©ry</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">F</forename><surname>Marion-Poll</surname></persName>
		</author>
		<title level="m" coord="13,395.18,305.98,85.41,7.86;13,151.52,316.93,27.15,7.86">Interactions insectesplantes</title>
		<imprint>
			<publisher>Editions Quae</publisher>
			<date type="published" when="2013">2013</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct coords="13,142.62,327.89,337.97,7.86;13,151.52,338.85,231.27,7.86" xml:id="b15">
	<monogr>
		<title level="m" type="main" coord="13,278.92,327.89,201.67,7.86;13,151.52,338.85,69.82,7.86">Very deep convolutional networks for large-scale image recognition</title>
		<author>
			<persName coords=""><forename type="first">K</forename><surname>Simonyan</surname></persName>
		</author>
		<author>
			<persName coords=""><forename type="first">A</forename><surname>Zisserman</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1409.1556</idno>
		<imprint>
			<date type="published" when="2014">2014</date>
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
